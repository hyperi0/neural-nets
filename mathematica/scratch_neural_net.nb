(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     62909,       1398]
NotebookOptionsPosition[     57525,       1301]
NotebookOutlinePosition[     57997,       1319]
CellTagsIndexPosition[     57954,       1316]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Neural Network Implementation", "Title",
 CellChangeTimes->{{3.901023259449683*^9, 3.901023264590308*^9}, {
  3.903165864814767*^9, 
  3.903165868869464*^9}},ExpressionUUID->"ca3228e6-303f-43ae-8a31-\
1f1db99b771c"],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.901023251546047*^9, 
  3.901023255934657*^9}},ExpressionUUID->"04a6c63a-cf94-442e-a622-\
d92ff422cef2"],

Cell[CellGroupData[{

Cell["Basic network functionality", "Subsubsection",
 CellChangeTimes->{{3.901024616772842*^9, 3.901024634445526*^9}, {
  3.903172246209255*^9, 
  3.9031722627676477`*^9}},ExpressionUUID->"ca5b47ac-52a1-4b2e-8d69-\
d5d72eb6fdb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "initialize", " ", "new", " ", "linear", " ", "layer", " ", "with", " ", 
    "randomly", " ", "distributed", " ", "weights", " ", "and", " ", 
    "biases"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"linearLayer", "[", 
     RowBox[{"inputs_", ",", " ", "neurons_", ",", " ", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"<|", "\[IndentingNewLine]", "\t\t", 
     RowBox[{
      RowBox[{"\"\<Inputs\>\"", " ", "->", " ", "inputs"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"\"\<Neurons\>\"", " ", "->", " ", "neurons"}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"\"\<Weights\>\"", " ", "->", " ", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<WeightDistribution\>\"", "]"}], ",",
          " ", 
         RowBox[{"{", 
          RowBox[{"neurons", ",", " ", "inputs"}], "}"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", "\t\t", 
      RowBox[{"\"\<Biases\>\"", " ", "->", " ", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{
         RowBox[{"OptionValue", "[", "\"\<BiasDistribution\>\"", "]"}], ",", 
         " ", "neurons"}], "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"\"\<ActivationFunction\>\"", " ", "->", " ", 
       RowBox[{"OptionValue", "[", "\"\<ActivationFunction\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "\t", "|>"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "linearLayer", "]"}], " ", "=", " ", 
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{
       "\"\<ActivationFunction\>\"", " ", "->", " ", "LogisticSigmoid"}], ",",
        "\n", "\t", 
       RowBox[{"\"\<WeightDistribution\>\"", " ", "->", " ", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", " ", "1"}], "]"}]}], ",", "\n", "\t", 
       RowBox[{"\"\<BiasDistribution\>\"", " ", "->", " ", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", " ", ".1"}], "]"}]}]}], "\n", "}"}]}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.900165558819038*^9, 3.90016557181672*^9}, {
   3.900507199837049*^9, 3.900507235401417*^9}, {3.9005078582081423`*^9, 
   3.900507866090992*^9}, {3.900508336361527*^9, 3.900508338690401*^9}, {
   3.901022226940144*^9, 3.90102224512673*^9}, {3.9011100043873167`*^9, 
   3.901110013422667*^9}, 3.9012785930870123`*^9, {3.9024908339851007`*^9, 
   3.9024908356495047`*^9}, {3.9024939211955547`*^9, 3.90249392301584*^9}, {
   3.902494217563992*^9, 3.90249421788262*^9}, {3.902495657056332*^9, 
   3.902495661453931*^9}, {3.903165035644363*^9, 3.903165057281646*^9}, {
   3.90316620777715*^9, 3.903166223879723*^9}, {3.90317227079084*^9, 
   3.903172379740481*^9}, {3.903172467091846*^9, 3.903172518108535*^9}, {
   3.903172656773942*^9, 3.903172666529422*^9}, {3.903173017521943*^9, 
   3.903173017641168*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"aa04fd5b-1529-45b5-bbc3-c5dedb8eb63c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "apply", " ", "weighted", " ", "summation", " ", "from", " ", "layer"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"applyLinearLayer", "[", 
    RowBox[{"layer_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"layer", "[", "\"\<Weights\>\"", "]"}], " ", ".", " ", 
     "inputs"}], " ", "+", " ", 
    RowBox[{"layer", "[", "\"\<Biases\>\"", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.9001658051989613`*^9, 3.900165846405797*^9}, {
  3.900165928877907*^9, 3.900165931094562*^9}, {3.900507221452429*^9, 
  3.900507221869989*^9}, {3.900507263939221*^9, 3.900507266659099*^9}, {
  3.900507304065806*^9, 3.900507329216206*^9}, {3.900507868453137*^9, 
  3.900507877144429*^9}, {3.901022265487055*^9, 3.901022268750958*^9}, {
  3.9031644664387503`*^9, 3.90316447438688*^9}, {3.9031658832761087`*^9, 
  3.9031659084138947`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"98de876e-a6bf-493a-b3a1-d5a132a89403"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "apply", " ", "activation", " ", "function", " ", "from", " ", "layer"}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"applyActivation", "[", 
    RowBox[{"layer_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"layer", "[", "\"\<ActivationFunction\>\"", "]"}], " ", "/@", " ",
     "inputs"}]}]}]], "Code",
 CellChangeTimes->{{3.900165485959984*^9, 3.900165493479166*^9}, {
  3.900165548571888*^9, 3.9001655492886467`*^9}, {3.900507216639189*^9, 
  3.900507218315398*^9}, {3.901022255363751*^9, 3.901022276703396*^9}, {
  3.903164477078908*^9, 3.903164477390665*^9}, {3.903165895966717*^9, 
  3.903165906666108*^9}, {3.9031726852518167`*^9, 3.9031726859674797`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"df87031d-db6b-4bc6-a67b-96b74e737cef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "feed", " ", "inputs", " ", "forward", " ", "through", " ", "each", " ", 
     "layer"}], ",", " ", 
    RowBox[{"sowing", " ", "summations", " ", "and", " ", "activations"}]}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"applyForwardPass", "[", 
    RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Fold", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"current", ",", " ", "layer"}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{"applyLinearLayer", "[", 
           RowBox[{"layer", ",", " ", "current"}], "]"}], ",", " ", 
          "\"\<Summations\>\""}], "]"}], " ", "//", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"applyActivation", "[", 
            RowBox[{"layer", ",", " ", "#"}], "]"}], ",", " ", 
           "\"\<Activations\>\""}], "]"}], " ", "&"}]}]}], "\n", "\t\t", 
      "]"}], ",", "\n", "\t\t", "inputs", ",", "\n", "\t\t", "layers"}], "\n",
     "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900165630117494*^9, 3.900165639390486*^9}, {
   3.900165761653887*^9, 3.900165768168208*^9}, {3.900165828705814*^9, 
   3.900165830038355*^9}, {3.900165863642522*^9, 3.900165877751355*^9}, {
   3.900507250563377*^9, 3.900507315948605*^9}, {3.900507353955459*^9, 
   3.9005074325958433`*^9}, {3.900507655040917*^9, 3.900507656991757*^9}, {
   3.900507880561081*^9, 3.900507903363222*^9}, {3.901022340162389*^9, 
   3.901022353853435*^9}, {3.901022794766786*^9, 3.901022800477303*^9}, 
   3.90316618971432*^9, {3.903168775360804*^9, 3.9031687767653627`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ffda7cc2-d670-4f52-a36a-178124c40009"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "reap", " ", "intermediates", " ", "and", " ", "return", " ", 
     "association", " ", "with", " ", "outputs"}], ",", " ", "summations", 
    ",", " ", 
    RowBox[{"and", " ", "activations"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"reapForwardPass", "[", 
    RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<Outputs\>\"", " ", "->", " ", 
        RowBox[{"applyForwardPass", "[", 
         RowBox[{"layers", ",", " ", "inputs"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"\"\<Summations\>\"", ",", " ", "\"\<Activations\>\""}], 
        "}"}], ",", "\n", "\t\t", "Rule"}], "\n", "\t", "]"}], " ", "//", " ",
      "Flatten"}], " ", "//", " ", 
    RowBox[{"Apply", "[", "Association", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.900507469937497*^9, 3.900507613554356*^9}, {
  3.900507659552443*^9, 3.900507662105192*^9}, {3.900507907599413*^9, 
  3.900507931878294*^9}, {3.903168784836252*^9, 3.903168785091758*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"ce3cf2e0-f924-4902-85f3-cb913ec0358e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Backpropagation", "Subsubsection",
 CellChangeTimes->{{3.9010246307879887`*^9, 3.901024631435306*^9}, {
  3.901800161644622*^9, 
  3.9018001629904737`*^9}},ExpressionUUID->"4453ef77-2ef7-4647-a1ca-\
56ec34df56c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "loss", " ", "for", " ", "single", " ", "training", " ", 
    "example", " ", "using", " ", "SSE"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateLoss", "[", 
    RowBox[{
    "output_", ",", " ", "target_", ",", " ", "\"\<SumSquaredError\>\""}], 
    "]"}], " ", ":=", "\[IndentingNewLine]", "\t", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"output", " ", "-", " ", "target"}], ")"}], " ", "^", " ", 
     "2"}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.901630524907728*^9, 3.901630546317006*^9}, {
  3.90163352184149*^9, 3.9016335482831583`*^9}, {3.901808177434681*^9, 
  3.901808187213448*^9}, {3.902495913558405*^9, 3.902495916162166*^9}, {
  3.9031644848911457`*^9, 3.903164498508013*^9}, {3.90316623774621*^9, 
  3.9031662380077057`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"c6ffa4c3-d8f5-496a-b9d3-bc3a37c5523c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "neuron", " ", "deltas", " ", "for", " ", "output", " ", "layer", " ", 
    RowBox[{"(", 
     RowBox[{"d", " ", "Error", " ", "d", " ", "Summation"}], ")"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateOutputDeltas", "[", 
    RowBox[{
    "output_", ",", " ", "target_", ",", " ", "summations_", ",", " ", 
     "activationFunction_", ",", " ", "\"\<SumSquaredError\>\""}], "]"}], " ",
    ":=", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"output", " ", "-", " ", "target"}], ")"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"activationFunction", "'"}], " ", "/@", " ", "summations"}], 
     ")"}]}]}]}]], "Code",
 CellChangeTimes->{{3.901630314468309*^9, 3.9016304884698277`*^9}, {
   3.901630520085877*^9, 3.901630532324779*^9}, {3.901633386574761*^9, 
   3.9016333914102173`*^9}, {3.9017147967291117`*^9, 3.901714808596643*^9}, {
   3.9017148416083403`*^9, 3.901714843689253*^9}, {3.902491032121838*^9, 
   3.902491050467914*^9}, {3.902491462944788*^9, 3.902491463944398*^9}, {
   3.902495910046281*^9, 3.902495911983239*^9}, {3.903164501067713*^9, 
   3.903164517012155*^9}, 3.903164665693939*^9, {3.903166245315802*^9, 
   3.903166249530464*^9}, {3.903172622306448*^9, 3.903172622415112*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"89769d09-775d-4eca-a696-20f110bf56f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "backpropagate", " ", "deltas", " ", "through", " ", "one", " ", "layer", 
    " ", "with", " ", "chain", " ", "rule"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "takes", " ", "deltas", " ", "and", " ", "weights", " ", "from", " ", 
     "next", " ", "layer"}], ",", " ", 
    RowBox[{
    "activation", " ", "and", " ", "summations", " ", "from", " ", "current", 
     " ", "layer"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateNextDeltas", "[", 
    RowBox[{
    "nextDeltas_", ",", " ", "weights_", ",", " ", "activationFunction_", ",",
      " ", "summations_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"nextDeltas", " ", ".", " ", "weights"}], ")"}], " ", "*", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"activationFunction", "'"}], " ", "/@", " ", "summations"}], 
     ")"}]}]}]}]], "Code",
 CellChangeTimes->{{3.900513274187667*^9, 3.900513469777364*^9}, {
  3.901022579228139*^9, 3.9010225937222633`*^9}, {3.901634197451151*^9, 
  3.901634198467231*^9}, {3.9024946424815397`*^9, 3.902494665586508*^9}, {
  3.903115724850971*^9, 3.903115746475389*^9}, {3.903164532762854*^9, 
  3.9031645354813967`*^9}, {3.9031645996775103`*^9, 3.903164648032353*^9}, {
  3.903164681105582*^9, 3.903164694667287*^9}, {3.90316897674087*^9, 
  3.9031689877806664`*^9}, {3.9031726260657053`*^9, 3.903172629356421*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"c978071f-e7a0-4984-9d5d-ac0a34bee3ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "backpropagate", " ", "output", " ", "deltas", " ", "through", " ", "all", 
    " ", "layers"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"backpropagateDeltas", "[", 
    RowBox[{"outputDeltas_", ",", " ", "layers_", ",", " ", "fp_"}], "]"}], 
   " ", ":=", "\n", "\n", "\t", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "take", " ", "activations", " ", "and", " ", "summations", " ", "from", 
      " ", "all", " ", "but", " ", "last", " ", "layer"}], ",", " ", 
     RowBox[{
     "weights", " ", "from", " ", "all", " ", "but", " ", "first", " ", 
      "layer"}]}], " ", "*)"}], "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{"Rest", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"layers", ",", " ", "\"\<Weights\>\""}], "]"}], "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"activationFunctions", " ", "=", " ", 
        RowBox[{"Most", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"layers", ",", " ", "\"\<ActivationFunction\>\""}], "]"}], 
         "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"summations", " ", "=", " ", 
        RowBox[{"Most", "[", 
         RowBox[{"fp", "[", "\"\<Summations\>\"", "]"}], "]"}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\n", "\t\t", 
     RowBox[{
      RowBox[{"FoldList", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"calculateNextDeltas", "[", 
          RowBox[{"#1", ",", " ", 
           RowBox[{"Sequence", " ", "@@", " ", "#2"}]}], "]"}], " ", "&"}], 
        ",", "\n", "\t\t\t", "outputDeltas", ",", "\n", "\t\t\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "is", " ", "there", " ", "a", " ", "built", " ", "in", " ", 
          "function", " ", "for", " ", 
          RowBox[{
           RowBox[{"MapThread", "[", 
            RowBox[{"List", ",", " ", "..."}], "]"}], "?", " ", "Riffle"}], 
          " ", "can", " ", "only", " ", "take", " ", "2", " ", "lists"}], " ",
          "*)"}], "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "weights", ",", " ", "activationFunctions", ",", " ", 
             "summations"}], "}"}]}], "]"}], " ", "//", " ", "Reverse"}]}], 
       "\n", "\t\t", "]"}], " ", "//", " ", "Reverse"}]}], "\n", "\t", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900603109094293*^9, 3.900603163497349*^9}, {
   3.9006032440354843`*^9, 3.900603419565837*^9}, {3.900603488475383*^9, 
   3.9006035249974318`*^9}, {3.901016285681773*^9, 3.901016286780085*^9}, {
   3.901022542297449*^9, 3.901022542639195*^9}, {3.901022581224289*^9, 
   3.9010225834412813`*^9}, {3.9010226309193773`*^9, 3.901022632832753*^9}, {
   3.901023860035762*^9, 3.901023886395125*^9}, {3.901024444557428*^9, 
   3.9010244471940107`*^9}, {3.901633638796508*^9, 3.90163364502101*^9}, {
   3.901634195420992*^9, 3.901634195855075*^9}, {3.902494658917717*^9, 
   3.902494660378654*^9}, 3.90249482154984*^9, 3.9024952770061293`*^9, {
   3.902495749939912*^9, 3.902495752564269*^9}, {3.903115762917081*^9, 
   3.903115875641626*^9}, {3.903115924608201*^9, 3.903116061914946*^9}, {
   3.9031162167486153`*^9, 3.903116218811425*^9}, {3.903116268407145*^9, 
   3.903116283918254*^9}, {3.903116348782777*^9, 3.9031163538776417`*^9}, {
   3.903164636418713*^9, 3.9031646396754436`*^9}, {3.903164673460485*^9, 
   3.903164676931986*^9}, {3.9031659177299547`*^9, 3.903166079968912*^9}, 
   3.9031661984893*^9, {3.903168803582531*^9, 3.903168821025776*^9}, {
   3.903168938126141*^9, 3.9031689682367983`*^9}, {3.90317263639076*^9, 
   3.903172640824655*^9}, {3.9031727017414837`*^9, 3.9031727025550537`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"4577cb3b-c01f-4395-9b98-5c9aa7ca6346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "error", " ", "gradients", " ", "wrt", " ", "weights", 
    " ", "from", " ", "gradients", " ", "wrt", " ", "summations"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateWeightGradients", "[", 
    RowBox[{"allDeltas_", ",", " ", "inputs_", ",", " ", "allActivations_"}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"deltas", ",", " ", "activations"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "deltas", "}"}], "]"}], " ", ".", " ", 
        RowBox[{"{", "activations", "}"}]}]}], "\[IndentingNewLine]", "\t\t", 
      "]"}], ",", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"allDeltas", ",", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Most", " ", "@", " ", "allActivations"}], ",", " ", 
         "inputs"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900683578897831*^9, 3.900683600900608*^9}, {
  3.900683651894773*^9, 3.900683704864881*^9}, {3.90068376612435*^9, 
  3.900683766731481*^9}, {3.901024457508309*^9, 3.901024500988913*^9}, {
  3.9017150704340773`*^9, 3.9017150731623096`*^9}, {3.901715293272192*^9, 
  3.901715295651433*^9}, {3.903093800696587*^9, 3.903093800935855*^9}, {
  3.90311522604278*^9, 3.903115226450479*^9}, {3.903168298793985*^9, 
  3.9031683017000504`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6269aca1-c6c8-41b8-aa7d-7582da787ed3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "all", " ", "neuron", " ", "deltas", " ", "and", " ", 
    "weight", " ", "gradients", " ", "by", " ", "backpropagating", " ", 
    "errors"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"backwardPass", "[", 
    RowBox[{"layers_", ",", " ", "labelledInput_Rule", ",", " ", 
     RowBox[{"lossFunction_", " ", ":", " ", "\"\<SumSquaredError\>\""}]}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "forwardPass", ",", " ", "outputDeltas", ",", " ", "allDeltas", ",", 
       " ", "weightGradients"}], "}"}], ",", "\n", "\t", "\n", "\t\t", 
     RowBox[{
      RowBox[{"forwardPass", " ", "=", " ", 
       RowBox[{"reapForwardPass", "[", 
        RowBox[{"layers", ",", " ", 
         RowBox[{"First", " ", "@", " ", "labelledInput"}]}], "]"}]}], ";", 
      "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"outputDeltas", " ", "=", " ", 
       RowBox[{"calculateOutputDeltas", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"forwardPass", "[", "\"\<Outputs\>\"", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"Last", "[", "labelledInput", "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"Last", "[", 
          RowBox[{"forwardPass", "[", "\"\<Summations\>\"", "]"}], "]"}], ",",
          "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"Last", "[", "layers", "]"}], "[", 
          "\"\<ActivationFunction\>\"", "]"}], ",", "\n", "\t\t\t", 
         "lossFunction"}], "\n", "\t\t", "]"}]}], ";", "\n", "\t\t", "\n", 
      "\t\t", 
      RowBox[{"allDeltas", " ", "=", " ", 
       RowBox[{"backpropagateDeltas", "[", 
        RowBox[{"outputDeltas", ",", " ", "layers", ",", " ", "forwardPass"}],
         "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"weightGradients", " ", "=", " ", 
       RowBox[{"calculateWeightGradients", "[", "\n", "\t\t\t", 
        RowBox[{"allDeltas", ",", "\n", "\t\t\t", 
         RowBox[{"First", " ", "@", " ", "labelledInput"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"forwardPass", "[", "\"\<Activations\>\"", "]"}]}], "\n", 
        "\t\t", "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<AllDeltas\>\"", " ", "->", " ", "allDeltas"}], ",", " ", 
        
        RowBox[{
        "\"\<WeightGradients\>\"", " ", "->", " ", "weightGradients"}]}], 
       "|>"}]}]}], "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900603002712975*^9, 3.9006031353216047`*^9}, {
   3.9006031920869503`*^9, 3.90060319414911*^9}, {3.900603536803502*^9, 
   3.900603539077364*^9}, {3.900603861458612*^9, 3.900603954871955*^9}, {
   3.900679070071116*^9, 3.900679075117937*^9}, {3.900679252987653*^9, 
   3.900679254193552*^9}, {3.9006794183390903`*^9, 3.900679431681649*^9}, {
   3.90067972445361*^9, 3.9006797264765997`*^9}, {3.900680336206019*^9, 
   3.900680365409309*^9}, {3.900681004503878*^9, 3.900681007033812*^9}, {
   3.9006810832099524`*^9, 3.900681084787387*^9}, {3.9006818885415897`*^9, 
   3.900681890533628*^9}, {3.9006838203710938`*^9, 3.900683933603942*^9}, {
   3.901016988597704*^9, 3.901017008641122*^9}, {3.901017082987296*^9, 
   3.90101714910404*^9}, {3.901022435652149*^9, 3.9010224493821077`*^9}, {
   3.901022517938695*^9, 3.901022537450086*^9}, {3.9010233265755873`*^9, 
   3.9010233718543043`*^9}, {3.901023628161152*^9, 3.901023729218135*^9}, {
   3.9010239735517282`*^9, 3.9010239918664417`*^9}, {3.9010243394036217`*^9, 
   3.901024419421636*^9}, {3.901109424900104*^9, 3.901109432657909*^9}, {
   3.9011096203235903`*^9, 3.901109631183823*^9}, 3.901197925373547*^9, 
   3.901286683886101*^9, {3.901290491926249*^9, 3.9012904922836447`*^9}, {
   3.90163340476285*^9, 3.90163351084157*^9}, 3.9016335699140177`*^9, {
   3.901633653455207*^9, 3.901633653971277*^9}, {3.901633732971491*^9, 
   3.9016337373499193`*^9}, {3.901634349624419*^9, 3.901634361055748*^9}, {
   3.901634567783557*^9, 3.901634572579876*^9}, {3.901634709508745*^9, 
   3.90163473147639*^9}, {3.9016347630880003`*^9, 3.9016347655467663`*^9}, {
   3.9016350430153923`*^9, 3.9016350513871183`*^9}, {3.9017148874374933`*^9, 
   3.901714890412567*^9}, {3.901715075531643*^9, 3.9017150877927647`*^9}, {
   3.9017152767281513`*^9, 3.901715324911949*^9}, {3.90171637601492*^9, 
   3.901716377744401*^9}, 3.901716789031891*^9, {3.9018029975828447`*^9, 
   3.9018029983686934`*^9}, {3.902492101503813*^9, 3.902492103467415*^9}, {
   3.9024925073248672`*^9, 3.9024925685190983`*^9}, {3.9024929187289257`*^9, 
   3.9024929443456593`*^9}, {3.9024946978919783`*^9, 
   3.9024946997368793`*^9}, {3.903116459632155*^9, 3.903116472889105*^9}, {
   3.903166409928857*^9, 3.90316643484249*^9}, {3.903167882474008*^9, 
   3.9031679352146683`*^9}, {3.903168129338724*^9, 3.9031682002050037`*^9}, {
   3.903168265719239*^9, 3.903168274084955*^9}, {3.903172719593397*^9, 
   3.9031727903413763`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"3d3648c8-da14-4990-9872-6260359c2f8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Training", "Subsubsection",
 CellChangeTimes->{{3.901800171954215*^9, 
  3.901800172583991*^9}},ExpressionUUID->"9ae4a78d-7d02-4250-924e-\
2b4968ff5cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "accumulate", " ", "gradients", " ", "over", " ", "multiple", " ", 
    "pieces", " ", "of", " ", "data", " ", "for", " ", "batch", " ", 
    "training"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"accumulateGradients", "[", 
    RowBox[{"layers_", ",", " ", "data_", ",", " ", "lossFunction_"}], "]"}], 
   " ", ":=", "\[IndentingNewLine]", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"gradients", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"backwardPass", "[", 
           RowBox[{"layers", ",", " ", "#", ",", " ", "lossFunction"}], "]"}],
           " ", "&"}], ",", " ", "data"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<WeightGradients\>\"", " ", "->", " ", 
        RowBox[{"Total", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"gradients", ",", " ", "\"\<WeightGradients\>\""}], "]"}], 
         "]"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<AllDeltas\>\"", " ", "->", " ", 
        RowBox[{"Total", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"gradients", ",", " ", "\"\<AllDeltas\>\""}], "]"}], 
         "]"}]}]}], "\n", "\t\t", "|>"}]}], "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9018029570628023`*^9, 3.901802968910029*^9}, {
   3.901803019869458*^9, 3.901803045487597*^9}, {3.901803083372738*^9, 
   3.9018030893433037`*^9}, {3.9018031248731947`*^9, 
   3.9018031439599953`*^9}, {3.90180321689712*^9, 3.901803263510257*^9}, {
   3.9018042831848803`*^9, 3.9018042954398003`*^9}, {3.903164711259547*^9, 
   3.903164727517149*^9}, 3.903168872615795*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"ebd0cc6d-a947-4085-b2e7-6757282650d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "update", " ", "weights", " ", "to", " ", "reduce", " ", "overall", " ", 
    "loss", " ", "according", " ", "to", " ", "weight", " ", "gradients", " ",
     "and", " ", "learning", " ", "rate"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"note", ":", " ", 
    RowBox[{
    "currently", " ", "uses", " ", "10", "%", " ", "of", " ", "learning", " ",
      "rate", " ", "for", " ", "bias", " ", "updates"}]}], " ", "*)"}], "\n", 
  
  RowBox[{
   RowBox[{"gradientDescentStep", "[", 
    RowBox[{"layers_", ",", " ", "gradients_", ",", " ", "learningRate_"}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"MapThread", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"layer", ",", " ", "weightGradients", ",", " ", "allDeltas"}],
         "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Append", "[", 
        RowBox[{"layer", ",", " ", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Weights\>\"", " ", "->", " ", 
            RowBox[{
             RowBox[{"layer", "[", "\"\<Weights\>\"", "]"}], " ", "-", " ", 
             RowBox[{"weightGradients", " ", "*", " ", "learningRate"}]}]}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<Biases\>\"", " ", "->", " ", 
            RowBox[{
             RowBox[{"layer", "[", "\"\<Biases\>\"", "]"}], " ", "-", " ", 
             RowBox[{
             "allDeltas", " ", "*", " ", "learningRate", " ", "*", " ", 
              ".1"}]}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
      "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"layers", ",", " ", 
       RowBox[{"gradients", "[", "\"\<WeightGradients\>\"", "]"}], ",", " ", 
       RowBox[{"gradients", "[", "\"\<AllDeltas\>\"", "]"}]}], "}"}]}], "\n", 
    "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900511912821782*^9, 3.9005119277274942`*^9}, {
  3.9005120744633512`*^9, 3.900512114151217*^9}, {3.900512159443112*^9, 
  3.900512178917329*^9}, {3.9005122129540987`*^9, 3.900512229616536*^9}, {
  3.9005124295229692`*^9, 3.9005124753163*^9}, {3.900512577362719*^9, 
  3.9005126674032087`*^9}, {3.900690081863041*^9, 3.9006900825742197`*^9}, {
  3.901023351593383*^9, 3.901023361245179*^9}, {3.9010245101732807`*^9, 
  3.901024537054229*^9}, {3.9011094916945*^9, 3.901109589463689*^9}, {
  3.901109702052659*^9, 3.901109726040989*^9}, {3.901803367029604*^9, 
  3.901803408183029*^9}, {3.901807700310163*^9, 3.901807729707556*^9}, {
  3.90180800010515*^9, 3.901808009705418*^9}, {3.903116635706853*^9, 
  3.903116637273943*^9}, {3.903164733967403*^9, 3.903164765255652*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"55ffb453-17d3-4ee3-8002-929f5b7a7b22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"split", " ", "data", " ", "into", " ", "batches"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{"batchData", "[", 
    RowBox[{"data_", ",", " ", "batchSize_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"RandomSample", "[", "data", "]"}], ",", " ", 
     RowBox[{"UpTo", "[", "batchSize", "]"}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.901803647683426*^9, 3.901803688354351*^9}, {
  3.901803946756959*^9, 3.9018039667405443`*^9}, {3.901806586335393*^9, 
  3.901806595329319*^9}, {3.903164771738138*^9, 3.903164776250025*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"21d00233-0056-4aae-8a25-bae8fad87dc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "update", " ", "network", " ", "based", " ", "on", " ", "one", " ", "full",
     " ", "pass", " ", "through", " ", "batched", " ", "data"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{"trainEpoch", "[", 
    RowBox[{"layers_List", ",", " ", "trainingData_List", ",", " ", 
     RowBox[{"OptionsPattern", "[", "trainNetwork", "]"}]}], "]"}], " ", ":=",
    "\n", "\t", 
   RowBox[{"Fold", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"currentLayers", ",", " ", "currentBatch"}], "}"}], ",", "\n",
        "\t\t\t", 
       RowBox[{"gradientDescentStep", "[", "\n", "\t\t\t\t", 
        RowBox[{"currentLayers", ",", "\n", "\t\t\t\t", 
         RowBox[{"accumulateGradients", "[", 
          RowBox[{"currentLayers", ",", " ", "currentBatch", ",", " ", 
           RowBox[{"OptionValue", "[", "\"\<LossFunction\>\"", "]"}]}], "]"}],
          ",", "\n", "\t\t\t\t", 
         RowBox[{"OptionValue", "[", "\"\<LearningRate\>\"", "]"}]}], "\n", 
        "\t\t\t", "]"}]}], "\n", "\t\t", "]"}], ",", "\n", "\t\t", "layers", 
     ",", "\n", "\t\t", 
     RowBox[{"batchData", "[", 
      RowBox[{"trainingData", ",", " ", 
       RowBox[{"OptionValue", "[", "\"\<BatchSize\>\"", "]"}]}], "]"}]}], 
    "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9017998811919527`*^9, 3.9017998823245993`*^9}, {
   3.901800060204404*^9, 3.901800066340807*^9}, {3.901800105808702*^9, 
   3.901800106197691*^9}, {3.901800256415745*^9, 3.9018002699733686`*^9}, {
   3.901801415205435*^9, 3.901801463767913*^9}, {3.901802341326042*^9, 
   3.901802523560871*^9}, {3.901802558579474*^9, 3.901802568992914*^9}, {
   3.901802676821824*^9, 3.901802693324708*^9}, {3.901803004306834*^9, 
   3.9018030046132927`*^9}, {3.901803417294675*^9, 3.901803515821364*^9}, {
   3.901803588619659*^9, 3.901803597707511*^9}, {3.9018039753222647`*^9, 
   3.9018039808559933`*^9}, {3.9018041214391193`*^9, 
   3.9018041219136257`*^9}, {3.901804277027039*^9, 3.90180427969048*^9}, {
   3.901806582375071*^9, 3.90180660700559*^9}, {3.901806722544519*^9, 
   3.901806723606635*^9}, 3.901806768872971*^9, {3.9018070881672783`*^9, 
   3.901807095641223*^9}, {3.902320877800837*^9, 3.9023208873177137`*^9}, {
   3.9031647794904833`*^9, 3.903164798315606*^9}, {3.903172880504459*^9, 
   3.903172928924428*^9}, {3.9031732293286667`*^9, 3.903173230395123*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"e345657e-15d6-4d2d-b835-d1f1fe20f2cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "apply", " ", "network", " ", "to", " ", "make", " ", "labelled", " ", 
    "predictions", " ", "for", " ", "each", " ", "input"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"makePredictions", "[", 
    RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"AssociationMap", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"applyForwardPass", "[", 
       RowBox[{"layers", ",", " ", "#"}], "]"}], " ", "&"}], ",", "\n", 
     "\t\t", "inputs"}], "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.901808338422319*^9, 3.9018083606827707`*^9}, {
   3.9018084234844913`*^9, 3.9018084844300833`*^9}, {3.902318616734191*^9, 
   3.902318639496204*^9}, {3.902318926016821*^9, 3.902318930414456*^9}, {
   3.903164803092215*^9, 3.9031648151169167`*^9}, 3.903166171813567*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"686ab6de-c707-4159-adf2-cea8d319cb8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "total", " ", "loss", " ", "over", " ", "all", " ", 
    "labelled", " ", "inputs"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateTotalLoss", "[", 
    RowBox[{"layers_", ",", " ", "labelledInputs_", ",", " ", 
     RowBox[{"lossFunction_", " ", ":", " ", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"trainNetwork", ",", " ", "\"\<LossFunction\>\""}], "]"}]}]}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"Map", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Function", "[", 
       RowBox[{"labelledInput", ",", "\n", "\t\t\t", 
        RowBox[{"calculateLoss", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"applyForwardPass", "[", 
           RowBox[{"layers", ",", " ", 
            RowBox[{"First", " ", "@", " ", "labelledInput"}]}], "]"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"Last", " ", "@", " ", "labelledInput"}], ",", "\n", 
          "\t\t\t\t", "lossFunction"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t",
        "]"}], ",", "\n", "\t\t", "labelledInputs"}], "\n", "\t", "]"}], " ", 
    "//", " ", "Total"}]}]}]], "Code",
 CellChangeTimes->{{3.901808168127442*^9, 3.9018082797681017`*^9}, 
   3.902318668182548*^9, {3.902318717493987*^9, 3.902318769718895*^9}, {
   3.90231884317493*^9, 3.902318868934816*^9}, {3.902319109072929*^9, 
   3.90231911429668*^9}, {3.9023204182773848`*^9, 3.90232062524131*^9}, {
   3.902320766670869*^9, 3.90232086185649*^9}, {3.902320902295478*^9, 
   3.9023209361342173`*^9}, {3.9031648172088633`*^9, 3.903164825516863*^9}, {
   3.903167449781254*^9, 3.903167490553039*^9}, {3.90316753257275*^9, 
   3.903167532822336*^9}, {3.903439583352681*^9, 3.903439585963812*^9}, {
   3.903528959301936*^9, 3.90352895977113*^9}, {3.903528994541507*^9, 
   3.903529006431625*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"f7f3a6ff-ea12-46b9-b4b5-5b0e9387a27e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"train", " ", "network"}], ",", " ", 
    RowBox[{"returning", " ", "final", " ", "result", " ", "only"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"trainNetwork", "[", 
     RowBox[{"initialLayers_List", ",", " ", "trainingData_List", ",", " ", 
      RowBox[{"opts", " ", ":", " ", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Nest", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Sow", "[", 
          RowBox[{"trainEpoch", "[", 
           RowBox[{"#", ",", " ", "trainingData", ",", " ", "opts"}], "]"}], 
          "]"}], " ", "&"}], ",", " ", "\n", "\t\t", "initialLayers", ",", 
        "\n", "\t\t", 
        RowBox[{"OptionValue", "[", "\"\<Epochs\>\"", "]"}]}], "\n", "\t", 
       "]"}], " ", "//", " ", "Reap"}], " ", "//", " ", 
     RowBox[{
      RowBox[{"trainingProgress", "[", 
       RowBox[{"#", ",", " ", "trainingData", ",", " ", 
        RowBox[{"OptionValue", "[", "\"\<LossFunction\>\"", "]"}], ",", " ", 
        RowBox[{"OptionValue", "[", "\"\<ShowProgress\>\"", "]"}]}], "]"}], 
      " ", "&"}]}]}], "\n", "\t", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "trainNetwork", "]"}], " ", "=", " ", 
     RowBox[{"{", "\n", "\t", 
      RowBox[{
       RowBox[{"\"\<LearningRate\>\"", " ", "->", " ", ".1"}], ",", "\n", 
       "\t", 
       RowBox[{
       "\"\<LossFunction\>\"", " ", "->", " ", "\"\<SumSquaredError\>\""}], 
       ",", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "change", " ", "this", " ", "option", " ", "for", " ", "pretty", " ", 
         "red", " ", "outputs"}], " ", "*)"}], "\n", "\t", 
       RowBox[{"\"\<BatchSize\>\"", " ", "->", " ", "1"}], ",", "\n", "\t", 
       RowBox[{"\"\<Epochs\>\"", " ", "->", " ", "1"}], ",", "\n", "\t", 
       RowBox[{"\"\<ShowProgress\>\"", " ", "->", " ", "True"}]}], "\n", 
      "}"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.901806615723435*^9, 3.901806665380992*^9}, {
   3.901806725143881*^9, 3.901806793795467*^9}, {3.90231852496126*^9, 
   3.902318526742195*^9}, {3.9023188892326727`*^9, 3.902318905232362*^9}, {
   3.902405936795697*^9, 3.902405941137631*^9}, {3.902487548349173*^9, 
   3.902487563769326*^9}, {3.902487962089617*^9, 3.9024879642197866`*^9}, {
   3.9024880592168713`*^9, 3.902488059745702*^9}, {3.903165090346429*^9, 
   3.903165210805522*^9}, {3.903165833443636*^9, 3.903165837909246*^9}, 
   3.9031661653655376`*^9, {3.903166442612381*^9, 3.903166456340028*^9}, {
   3.903167392025838*^9, 3.9031673956680593`*^9}, {3.903168465116663*^9, 
   3.903168484193619*^9}, {3.903168531004583*^9, 3.903168536123163*^9}, {
   3.903168592231112*^9, 3.903168592727807*^9}, {3.903172850443058*^9, 
   3.903172865961381*^9}, {3.9031732209680767`*^9, 3.903173222293167*^9}, {
   3.9034376873306437`*^9, 3.9034377261381083`*^9}, {3.903437890051901*^9, 
   3.903437896694585*^9}, {3.903438528774946*^9, 3.9034385301296873`*^9}, {
   3.903438836830419*^9, 3.903438854530881*^9}, {3.903439501606832*^9, 
   3.9034395024152403`*^9}, {3.9034533235715017`*^9, 
   3.9034533267440157`*^9}, {3.90345354932298*^9, 3.903453552434771*^9}, {
   3.903454119345541*^9, 3.903454128977621*^9}, 3.9034543054270782`*^9, {
   3.9034545108855124`*^9, 3.903454514961236*^9}, {3.903528876560758*^9, 
   3.903528911558249*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"5e2f8e5b-1e6f-4b8c-9ddd-67f584f73e53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "graph", " ", "training", " ", "loss", " ", "across", " ", "epochs"}], " ",
    "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"trainingProgress", "[", 
     RowBox[{
     "training_", ",", " ", "trainingData_", ",", " ", "lossFunction_", ",", 
      " ", 
      RowBox[{"showProgress_", " ", "/;", " ", 
       RowBox[{"TrueQ", "[", "showProgress", "]"}]}]}], "]"}], " ", ":=", 
    "\n", "\t", 
    RowBox[{"(*", " ", 
     RowBox[{
     "reap", " ", "intermediate", " ", "networks", " ", "from", " ", 
      "training", " ", "to", " ", "track", " ", "progress"}], " ", "*)"}], 
    "\n", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"networks", ",", " ", "trainingLoss"}], "}"}], ",", "\n", "\t",
       "\n", "\t\t", 
      RowBox[{
       RowBox[{"networks", " ", "=", " ", 
        RowBox[{
         RowBox[{"training", " ", "//", " ", "Rest"}], " ", "//", " ", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"#", ",", " ", "2"}], "]"}], " ", "&"}]}]}], ";", "\n", 
       "\t\t", 
       RowBox[{"trainingLoss", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"calculateTotalLoss", "[", 
            RowBox[{"#", ",", " ", "trainingData", ",", " ", "lossFunction"}],
             "]"}], " ", "&"}], ",", " ", "networks"}], "]"}]}], ";", "\n", 
       "\t\t", "\n", "\t\t", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", "\n", "\t\t\t", 
         RowBox[{"trainingLoss", ",", "\n", "\t\t\t", 
          RowBox[{"Frame", " ", "->", " ", "True"}], ",", "\n", "\t\t\t", 
          RowBox[{"FrameLabel", " ", "->", " ", 
           RowBox[{"{", 
            RowBox[{"\"\<Epochs\>\"", ",", " ", "\"\<Loss\>\""}], "}"}]}]}], 
         "\n", "\t\t", "]"}], " ", "//", " ", "CellPrint"}], ";", "\n", 
       "\t\t", "\n", "\t\t", 
       RowBox[{"Last", " ", "@", " ", "networks"}]}]}], "\n", "\t", "]"}]}], 
   "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "do", " ", "nothing", " ", "if", " ", "\"\<ShowProgress\>\"", " ", 
     "option", " ", "is", " ", "False"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"trainingProgress", "[", 
     RowBox[{
     "training_", ",", " ", "trainingData_", ",", " ", "lossFunction_", ",", 
      " ", 
      RowBox[{"showProgress_", " ", "/;", " ", 
       RowBox[{"!", 
        RowBox[{"TrueQ", "[", "showProgress", "]"}]}]}]}], "]"}], " ", ":=", 
    "\n", "\t", 
    RowBox[{"First", " ", "@", " ", "training"}]}]}]}]], "Code",
 CellChangeTimes->{{3.903437902251782*^9, 3.9034379458680887`*^9}, {
   3.903438586349777*^9, 3.9034387357808228`*^9}, {3.9034387717196903`*^9, 
   3.9034388440303793`*^9}, {3.903438880101191*^9, 3.903438883755629*^9}, {
   3.903439017617518*^9, 3.903439021335231*^9}, {3.9034390948151293`*^9, 
   3.903439115444316*^9}, {3.903439162753734*^9, 3.903439184828189*^9}, {
   3.903439233983397*^9, 3.9034392390565023`*^9}, 3.9034393602659397`*^9, {
   3.903439407329175*^9, 3.903439456219051*^9}, {3.9034395105652103`*^9, 
   3.9034395326751223`*^9}, {3.9034529245160713`*^9, 3.903452936362691*^9}, {
   3.903452975360942*^9, 3.90345302895505*^9}, 3.903453120327682*^9, {
   3.903453161764451*^9, 3.90345321347611*^9}, {3.9034533671717653`*^9, 
   3.903453369805553*^9}, {3.9034535556403913`*^9, 3.9034536012068577`*^9}, {
   3.903453709055463*^9, 3.903453715731238*^9}, {3.903453747509513*^9, 
   3.9034538053629*^9}, {3.903453865604269*^9, 3.903453867541936*^9}, {
   3.9034539818056307`*^9, 3.903453981833897*^9}, {3.903454051214985*^9, 
   3.903454073756481*^9}, {3.9034541108014812`*^9, 3.903454112667449*^9}, {
   3.9034542970113297`*^9, 3.9034543700920467`*^9}, {3.903454437817672*^9, 
   3.903454455475792*^9}, {3.903454503936884*^9, 3.903454504898623*^9}, {
   3.903454545381599*^9, 3.903454550054195*^9}, {3.903454601329042*^9, 
   3.903454612325139*^9}, {3.9035288409899797`*^9, 3.9035288558375387`*^9}, {
   3.903528896213482*^9, 3.9035289213963614`*^9}, {3.903529046429049*^9, 
   3.903529060768757*^9}, {3.903529108118598*^9, 3.903529109582663*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"c8dfffcf-656d-433f-87a4-eedb6af65f05"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example: Learning XOR", "Section",
 CellChangeTimes->{{3.903166580634541*^9, 3.903166584703045*^9}, {
  3.9031720427816677`*^9, 
  3.903172058461977*^9}},ExpressionUUID->"de2a3a50-09a3-411f-bc59-\
c4de8f971870"],

Cell[CellGroupData[{

Cell["Setup learning parameters", "Subsubsection",
 CellChangeTimes->{{3.90317202223011*^9, 
  3.90317203366313*^9}},ExpressionUUID->"f6bd0a29-df71-42f6-9d85-\
4fddeb38c82a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"learningRate", " ", "=", " ", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lossFunction", " ", "=", " ", "\"\<SumSquaredError\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"batchSize", " ", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"epochs", " ", "=", "10000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.901017329158189*^9, 3.901017332531003*^9}, {
   3.9018068440837317`*^9, 3.901806859107897*^9}, 3.902318486664823*^9, {
   3.902490854712974*^9, 3.90249089174892*^9}, {3.902493091192256*^9, 
   3.9024931103491287`*^9}, 3.902493383524057*^9, 3.902493954344953*^9, 
   3.9024940466428967`*^9, {3.902496636802487*^9, 3.9024966510016413`*^9}, 
   3.9031166005963984`*^9, 3.903116742589589*^9, 3.9031168358766747`*^9, {
   3.903116925681357*^9, 3.903116950801052*^9}, {3.90316659665796*^9, 
   3.903166598257634*^9}, {3.9034394431658773`*^9, 3.903439443264462*^9}, {
   3.903439550851685*^9, 3.9034395509938707`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"015174ad-d5c8-4067-b046-6d50c3b4fdff"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Build training dataset", "Subsubsection",
 CellChangeTimes->{{3.903172036505506*^9, 3.903172038897298*^9}, 
   3.9034390377901278`*^9},ExpressionUUID->"fbde7219-7543-4864-a528-\
b68ba5a14a69"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"inputs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"targets", " ", "=", " ", 
   RowBox[{"List", " ", "/@", " ", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "1", ",", "0"}], "}"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.9031693228322372`*^9, 3.90316935386261*^9}, {
  3.9031693883955584`*^9, 3.903169389176524*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"0111ca61-7b58-4638-92f3-52cdd1d5d194"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingData", " ", "=", " ", 
   RowBox[{"MapThread", "[", 
    RowBox[{"Rule", ",", " ", 
     RowBox[{"{", 
      RowBox[{"inputs", ",", " ", "targets"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.9024929885285263`*^9, 3.902493031432911*^9}, {
  3.903171885106619*^9, 3.9031718970792437`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"5446ad54-368e-411b-aeab-e2267ca2a645"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Create network with randomly initialized layers", "Subsubsection",
 CellChangeTimes->{{3.90317206515396*^9, 
  3.903172097292447*^9}},ExpressionUUID->"56140d67-e359-4a82-a6f7-\
586c2a625b45"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"network", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"linearLayer", "[", 
     RowBox[{"2", ",", " ", "2"}], "]"}], ",", 
    RowBox[{"linearLayer", "[", 
     RowBox[{"2", ",", " ", "1"}], "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.901017305750147*^9, 3.901017324897551*^9}, {
   3.901017430713305*^9, 3.90101743255249*^9}, 3.9010226678129377`*^9, {
   3.901022867704577*^9, 3.901022868679647*^9}, {3.9017165701813583`*^9, 
   3.9017165728002443`*^9}, {3.902491126520815*^9, 3.902491128817457*^9}, {
   3.902492112682837*^9, 3.902492112979579*^9}, 3.9024930375242453`*^9, {
   3.902494020856345*^9, 3.902494031733279*^9}, {3.902495795332776*^9, 
   3.90249579561031*^9}, {3.902495829120925*^9, 3.902495830931634*^9}, {
   3.9024964789244537`*^9, 3.902496479415269*^9}, 3.9024965213302727`*^9, {
   3.902496586685092*^9, 3.902496598592475*^9}, {3.9024966796085243`*^9, 
   3.902496699287209*^9}, {3.903116797049548*^9, 3.90311679779836*^9}, {
   3.903116831328376*^9, 3.903116853268544*^9}, {3.903172085846242*^9, 
   3.903172086700157*^9}, {3.903172968373144*^9, 3.903172968941663*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"284bf659-3a88-4949-913c-91cc040489c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Inputs\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Neurons\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Weights\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.4078064385426459`", ",", "1.0296449442456974`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"1.7978702772924084`", ",", "0.17959051521511712`"}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"\<\"Biases\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.07273473486733549`", ",", "0.11225953322415075`"}], "}"}]}],
      ",", 
     RowBox[{"\<\"ActivationFunction\"\>", "\[Rule]", "LogisticSigmoid"}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Inputs\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Neurons\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"Weights\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.5654602429728273`"}], ",", 
         RowBox[{"-", "0.22092726961105896`"}]}], "}"}], "}"}]}], ",", 
     RowBox[{"\<\"Biases\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "0.06871231748609394`"}], "}"}]}], ",", 
     RowBox[{"\<\"ActivationFunction\"\>", "\[Rule]", "LogisticSigmoid"}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.903169189536758*^9, 3.903169411769224*^9, {3.903171878510795*^9, 
   3.9031718989076*^9}, 3.903172099699951*^9, 3.903172988501874*^9, 
   3.903173023692607*^9, 3.9031732420163727`*^9, 3.903439049359277*^9, 
   3.903439281522709*^9, 3.90343955692768*^9, 3.903452945523019*^9, 
   3.903453395300364*^9, 3.903453668042259*^9, 3.9034540202232122`*^9, 
   3.903454097170044*^9, 3.90352893465757*^9, 3.903528974434669*^9, 
   3.903529138391865*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"f9c438fe-94fb-4d19-8c45-5d2b06c67dea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make predictions with untrained network", "Subsubsection",
 CellChangeTimes->{{3.903172105525857*^9, 3.903172115898481*^9}, {
  3.903172178268282*^9, 
  3.903172192943179*^9}},ExpressionUUID->"61202c68-67b1-4bdc-b6c0-\
2566bed0c345"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makePredictions", "[", 
  RowBox[{"network", ",", " ", "inputs"}], "]"}]], "Input",
 CellChangeTimes->{{3.90311665857721*^9, 3.903116662669249*^9}, {
  3.9031730301734343`*^9, 3.903173030663196*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"dd0e6bdc-e3e3-4187-9145-cafd01f05ba0"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.26961965080424677`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.2025581565824977`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.1770510075258936`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.15275742624633243`", "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.903116663054599*^9, 3.90311676196434*^9, 3.90311686277427*^9, {
   3.903116934611534*^9, 3.90311695939072*^9}, 3.903169474270211*^9, 
   3.9031697860555964`*^9, {3.903171796252705*^9, 3.9031718262688847`*^9}, 
   3.903171860648109*^9, 3.903171901814107*^9, 3.903173031118395*^9, 
   3.9031732433951397`*^9, 3.903439050568963*^9, 3.903439282580915*^9, 
   3.903439557882256*^9, 3.9034529469785023`*^9, 3.90345339655877*^9, 
   3.903453669060527*^9, 3.903454021070175*^9, 3.9034540980447283`*^9, 
   3.903528935738743*^9, 3.9035289755051613`*^9, 3.903529139358493*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"c675a31d-cd91-4495-b29b-8a5768768c2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calculateTotalLoss", "[", 
  RowBox[{"network", ",", " ", "trainingData"}], "]"}]], "Input",
 CellChangeTimes->{{3.9034395762477493`*^9, 3.903439614141391*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"8d6fa170-dfad-4f6e-a658-556a1261e028"],

Cell[BoxData["1.409188125220459`"], "Output",
 CellChangeTimes->{{3.903439598245541*^9, 3.9034396144093447`*^9}, 
   3.903452948264366*^9, 3.903453397159307*^9, 3.9034536695807877`*^9, 
   3.903454021775741*^9, 3.903454099594159*^9, 3.903528936196493*^9, 
   3.903528977099174*^9, 3.903529015039401*^9, 3.9035291398481083`*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"9f829cbd-fc08-43ae-8f06-57b065d644b8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Train network", "Subsubsection",
 CellChangeTimes->{{3.903172123228034*^9, 
  3.9031721241917973`*^9}},ExpressionUUID->"8598e2fe-e735-4836-9772-\
c10205af5b90"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"trainedNetwork", " ", "=", " ", 
  RowBox[{"trainNetwork", "[", "\[IndentingNewLine]", 
   RowBox[{
   "network", ",", "\[IndentingNewLine]", "trainingData", ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<LearningRate\>\"", "->", " ", "learningRate"}], ",", " ", 
    RowBox[{"\"\<LossFunction\>\"", " ", "->", " ", "lossFunction"}], ",", 
    " ", 
    RowBox[{"\"\<BatchSize\>\"", " ", "->", " ", "batchSize"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<Epochs\>\"", "->", "10000"}], ",", "\[IndentingNewLine]", 
    RowBox[{"\"\<ShowProgress\>\"", "->", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9024886771777477`*^9, 3.9024886997283916`*^9}, {
   3.9031666075503902`*^9, 3.9031666359928083`*^9}, {3.903169173173389*^9, 
   3.903169176263535*^9}, {3.9031721289328938`*^9, 3.903172142512114*^9}, 
   3.903439143110564*^9, {3.903439217593555*^9, 3.903439221216392*^9}, 
   3.903439637130521*^9, {3.903452957806527*^9, 3.9034529846517487`*^9}, {
   3.903453032820623*^9, 3.903453042611576*^9}, {3.903453148231822*^9, 
   3.9034531534237757`*^9}, {3.9034532012803698`*^9, 3.903453202927485*^9}, {
   3.903453774410376*^9, 3.9034537748319674`*^9}, {3.903454031892096*^9, 
   3.903454032233425*^9}, {3.9034543254661627`*^9, 3.903454325899602*^9}, {
   3.903454466779777*^9, 3.903454490213827*^9}, {3.903454564171781*^9, 
   3.90345458841784*^9}, {3.903454622186685*^9, 3.903454622608873*^9}, {
   3.9035290214264936`*^9, 3.903529021763885*^9}, {3.903529068292552*^9, 
   3.9035290686949387`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"4f576cdc-79c7-4bd2-b925-365f14b7c65f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Inputs\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Neurons\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"ActivationFunction\"\>", "\[Rule]", "LogisticSigmoid"}], 
     ",", 
     RowBox[{"\<\"Weights\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1.957622118932393`", ",", "1.9569633277845113`"}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"7.73833651867946`", ",", "7.7182000588524255`"}], "}"}]}], 
       "}"}]}], ",", 
     RowBox[{"\<\"Biases\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "2.583911246327681`"}], ",", 
        RowBox[{"-", "3.193813171545944`"}]}], "}"}]}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Inputs\"\>", "\[Rule]", "2"}], ",", 
     RowBox[{"\<\"Neurons\"\>", "\[Rule]", "1"}], ",", 
     RowBox[{"\<\"ActivationFunction\"\>", "\[Rule]", "LogisticSigmoid"}], 
     ",", 
     RowBox[{"\<\"Weights\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "18.233768320828297`"}], ",", "13.313734163266446`"}], 
        "}"}], "}"}]}], ",", 
     RowBox[{"\<\"Biases\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"-", "2.7724975849646865`"}], "}"}]}]}], 
    "\[RightAssociation]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.903529115835038*^9, 3.9035291431474867`*^9}},
 CellLabel->"Out[60]=",ExpressionUUID->"95fab52f-543a-4e7d-861c-ac20a19d1dcb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Make predictions from trained network", "Subsubsection",
 CellChangeTimes->{{3.90317217123349*^9, 
  3.903172197089994*^9}},ExpressionUUID->"f2f086bc-9a70-4a2a-93df-\
1f8e877332c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"makePredictions", "[", 
  RowBox[{"trainedNetwork", ",", " ", "inputs"}], "]"}]], "Input",
 CellChangeTimes->{{3.90311666381614*^9, 3.903116667386344*^9}, {
  3.9031732591227922`*^9, 3.903173261097753*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"449f97db-7349-4626-9a21-7037f067c1cc"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.0285367040609683`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.9828657720663548`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.9828672889593895`", "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", "0.020215871035454733`", "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.90311666777055*^9, 3.903116762525195*^9, 3.903116863344865*^9, {
   3.903116935140586*^9, 3.903116960893592*^9}, 3.903169475591353*^9, 
   3.90316978686847*^9, {3.9031717974750843`*^9, 3.903171826992075*^9}, 
   3.903171861422502*^9, 3.903171913193795*^9, 3.9031732615801086`*^9, 
   3.903439081147806*^9, 3.903439566415917*^9, 3.9034396466463823`*^9, 
   3.903453343338941*^9, 3.903453680432632*^9, 3.903529074748604*^9, {
   3.903529118299773*^9, 3.903529144426347*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"0f00e5c1-d0b0-4262-a7ae-fb424441ae41"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"calculateTotalLoss", "[", 
  RowBox[{"trainedNetwork", ",", " ", "trainingData"}], "]"}]], "Input",
 CellChangeTimes->{{3.903439619570602*^9, 3.903439621054281*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"f66797b0-885e-4fd0-ae32-c6fbe3f93a2d"],

Cell[BoxData["0.0018101364748685867`"], "Output",
 CellChangeTimes->{{3.903439621429747*^9, 3.903439647917275*^9}, {
  3.903529120375861*^9, 3.903529146645495*^9}},
 CellLabel->"Out[62]=",ExpressionUUID->"224d2fd4-8be6-43ad-82ef-2b8feaaf07e9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 847},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a227bd47-836e-473b-946f-c2bac241dc7a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 221, 4, 107, "Title",ExpressionUUID->"ca3228e6-303f-43ae-8a31-1f1db99b771c"],
Cell[CellGroupData[{
Cell[826, 30, 165, 3, 74, "Section",ExpressionUUID->"04a6c63a-cf94-442e-a622-d92ff422cef2"],
Cell[CellGroupData[{
Cell[1016, 37, 229, 4, 49, "Subsubsection",ExpressionUUID->"ca5b47ac-52a1-4b2e-8d69-d5d72eb6fdb1"],
Cell[1248, 43, 3000, 61, 352, "Code",ExpressionUUID->"aa04fd5b-1529-45b5-bbc3-c5dedb8eb63c"],
Cell[4251, 106, 1011, 21, 100, "Code",ExpressionUUID->"98de876e-a6bf-493a-b3a1-d5a132a89403"],
Cell[5265, 129, 840, 17, 100, "Code",ExpressionUUID->"df87031d-db6b-4bc6-a67b-96b74e737cef"],
Cell[6108, 148, 1857, 40, 247, "Code",ExpressionUUID->"ffda7cc2-d670-4f52-a36a-178124c40009"],
Cell[7968, 190, 1228, 27, 184, "Code",ExpressionUUID->"ce3cf2e0-f924-4902-85f3-cb913ec0358e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9233, 222, 219, 4, 49, "Subsubsection",ExpressionUUID->"4453ef77-2ef7-4647-a1ca-56ec34df56c2"],
Cell[9455, 228, 939, 21, 100, "Code",ExpressionUUID->"c6ffa4c3-d8f5-496a-b9d3-bc3a37c5523c"],
Cell[10397, 251, 1402, 29, 100, "Code",ExpressionUUID->"89769d09-775d-4eca-a696-20f110bf56f9"],
Cell[11802, 282, 1530, 33, 121, "Code",ExpressionUUID->"c978071f-e7a0-4984-9d5d-ac0a34bee3ea"],
Cell[13335, 317, 3902, 80, 394, "Code",ExpressionUUID->"4577cb3b-c01f-4395-9b98-5c9aa7ca6346"],
Cell[17240, 399, 1691, 37, 205, "Code",ExpressionUUID->"6269aca1-c6c8-41b8-aa7d-7582da787ed3"],
Cell[18934, 438, 5020, 90, 541, "Code",ExpressionUUID->"3d3648c8-da14-4990-9872-6260359c2f8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23991, 533, 159, 3, 49, "Subsubsection",ExpressionUUID->"9ae4a78d-7d02-4250-924e-2b4968ff5cc5"],
Cell[24153, 538, 1825, 40, 205, "Code",ExpressionUUID->"ebd0cc6d-a947-4085-b2e7-6757282650d4"],
Cell[25981, 580, 2771, 56, 289, "Code",ExpressionUUID->"55ffb453-17d3-4ee3-8002-929f5b7a7b22"],
Cell[28755, 638, 713, 15, 100, "Code",ExpressionUUID->"21d00233-0056-4aae-8a25-bae8fad87dc2"],
Cell[29471, 655, 2527, 47, 310, "Code",ExpressionUUID->"e345657e-15d6-4d2d-b835-d1f1fe20f2cb"],
Cell[32001, 704, 953, 19, 163, "Code",ExpressionUUID->"686ab6de-c707-4159-adf2-cea8d319cb8a"],
Cell[32957, 725, 1935, 38, 289, "Code",ExpressionUUID->"f7f3a6ff-ea12-46b9-b4b5-5b0e9387a27e"],
Cell[34895, 765, 3532, 70, 352, "Code",ExpressionUUID->"5e2f8e5b-1e6f-4b8c-9ddd-67f584f73e53"],
Cell[38430, 837, 4203, 87, 457, "Code",ExpressionUUID->"c8dfffcf-656d-433f-87a4-eedb6af65f05"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42682, 930, 217, 4, 74, "Section",ExpressionUUID->"de2a3a50-09a3-411f-bc59-c4de8f971870"],
Cell[CellGroupData[{
Cell[42924, 938, 174, 3, 49, "Subsubsection",ExpressionUUID->"f6bd0a29-df71-42f6-9d85-4fddeb38c82a"],
Cell[43101, 943, 1089, 20, 104, "Input",ExpressionUUID->"015174ad-d5c8-4067-b046-6d50c3b4fdff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44227, 968, 198, 3, 49, "Subsubsection",ExpressionUUID->"fbde7219-7543-4864-a528-b68ba5a14a69"],
Cell[44428, 973, 757, 21, 58, "Input",ExpressionUUID->"0111ca61-7b58-4638-92f3-52cdd1d5d194"],
Cell[45188, 996, 428, 10, 34, "Input",ExpressionUUID->"5446ad54-368e-411b-aeab-e2267ca2a645"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45653, 1011, 197, 3, 49, "Subsubsection",ExpressionUUID->"56140d67-e359-4a82-a6f7-586c2a625b45"],
Cell[CellGroupData[{
Cell[45875, 1018, 1210, 20, 34, "Input",ExpressionUUID->"284bf659-3a88-4949-913c-91cc040489c0"],
Cell[47088, 1040, 1967, 45, 67, "Output",ExpressionUUID->"f9c438fe-94fb-4d19-8c45-5d2b06c67dea"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[49104, 1091, 239, 4, 49, "Subsubsection",ExpressionUUID->"61202c68-67b1-4bdc-b6c0-2566bed0c345"],
Cell[CellGroupData[{
Cell[49368, 1099, 302, 5, 34, "Input",ExpressionUUID->"dd0e6bdc-e3e3-4187-9145-cafd01f05ba0"],
Cell[49673, 1106, 1299, 29, 38, "Output",ExpressionUUID->"c675a31d-cd91-4495-b29b-8a5768768c2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[51009, 1140, 263, 4, 34, "Input",ExpressionUUID->"8d6fa170-dfad-4f6e-a658-556a1261e028"],
Cell[51275, 1146, 406, 5, 38, "Output",ExpressionUUID->"9f829cbd-fc08-43ae-8f06-57b065d644b8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[51730, 1157, 166, 3, 49, "Subsubsection",ExpressionUUID->"8598e2fe-e735-4836-9772-c10205af5b90"],
Cell[CellGroupData[{
Cell[51921, 1164, 1626, 26, 150, "Input",ExpressionUUID->"4f576cdc-79c7-4bd2-b925-365f14b7c65f"],
Cell[53550, 1192, 1594, 41, 67, "Output",ExpressionUUID->"95fab52f-543a-4e7d-861c-ac20a19d1dcb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55193, 1239, 187, 3, 49, "Subsubsection",ExpressionUUID->"f2f086bc-9a70-4a2a-93df-1f8e877332c5"],
Cell[CellGroupData[{
Cell[55405, 1246, 309, 5, 34, "Input",ExpressionUUID->"449f97db-7349-4626-9a21-7037f067c1cc"],
Cell[55717, 1253, 1205, 28, 38, "Output",ExpressionUUID->"0f00e5c1-d0b0-4262-a7ae-fb424441ae41"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56959, 1286, 268, 4, 34, "Input",ExpressionUUID->"f66797b0-885e-4fd0-ae32-c6fbe3f93a2d"],
Cell[57230, 1292, 243, 3, 38, "Output",ExpressionUUID->"224d2fd4-8be6-43ad-82ef-2b8feaaf07e9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

