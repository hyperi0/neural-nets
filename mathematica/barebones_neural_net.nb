(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     38360,        845]
NotebookOptionsPosition[     34864,        787]
NotebookOutlinePosition[     35355,        805]
CellTagsIndexPosition[     35312,        802]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Barebones Neural Network Implementation", "Title",
 CellChangeTimes->{{3.901023259449683*^9, 
  3.901023264590308*^9}},ExpressionUUID->"ca3228e6-303f-43ae-8a31-\
1f1db99b771c"],

Cell["\<\
Neural network as a list of linear layers with associated activation \
functions
Can use and train with simple numerical data\
\>", "Subsection",
 CellChangeTimes->{{3.901023267939083*^9, 
  3.9010233060919027`*^9}},ExpressionUUID->"34157afd-8aae-46c5-a27a-\
5e0c13c73a08"],

Cell[CellGroupData[{

Cell["Function Definitions", "Section",
 CellChangeTimes->{{3.901023251546047*^9, 
  3.901023255934657*^9}},ExpressionUUID->"04a6c63a-cf94-442e-a622-\
d92ff422cef2"],

Cell[CellGroupData[{

Cell["Structure", "Subsubsection",
 CellChangeTimes->{{3.901024616772842*^9, 
  3.901024634445526*^9}},ExpressionUUID->"ca5b47ac-52a1-4b2e-8d69-\
d5d72eb6fdb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "initialize", " ", "new", " ", "linear", " ", "layer", " ", "with", " ", 
    "randomly", " ", "distributed", " ", "weights", " ", "and", " ", 
    "biases"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"linearLayer", "[", 
    RowBox[{"inputs_", ",", " ", "neurons_", ",", " ", 
     RowBox[{"activation_", " ", ":", " ", "LogisticSigmoid"}]}], "]"}], " ", 
   ":=", "\n", "\t", 
   RowBox[{"<|", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Inputs\>\"", " ", "->", " ", "inputs"}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"\"\<Neurons\>\"", " ", "->", " ", "neurons"}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"\"\<Weights\>\"", "->", " ", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"0", ",", "1"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"neurons", ",", " ", "inputs"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\t\t", 
     RowBox[{"\"\<Biases\>\"", " ", "->", " ", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", " ", "neurons"}], "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Activation\>\"", " ", "->", " ", "activation"}]}], 
    "\[IndentingNewLine]", "\t", "|>"}]}]}]], "Code",
 CellChangeTimes->{{3.900165558819038*^9, 3.90016557181672*^9}, {
   3.900507199837049*^9, 3.900507235401417*^9}, {3.9005078582081423`*^9, 
   3.900507866090992*^9}, {3.900508336361527*^9, 3.900508338690401*^9}, {
   3.901022226940144*^9, 3.90102224512673*^9}, {3.9011100043873167`*^9, 
   3.901110013422667*^9}, 3.9012785930870123`*^9, {3.9024908339851007`*^9, 
   3.9024908356495047`*^9}, {3.9024939211955547`*^9, 3.90249392301584*^9}, {
   3.902494217563992*^9, 3.90249421788262*^9}, {3.902495657056332*^9, 
   3.902495661453931*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"aa04fd5b-1529-45b5-bbc3-c5dedb8eb63c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyLinearLayer", "[", 
   RowBox[{"layer_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"layer", "[", "\"\<Weights\>\"", "]"}], " ", ".", " ", "inputs"}],
    " ", "+", " ", 
   RowBox[{"layer", "[", "\"\<Biases\>\"", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.9001658051989613`*^9, 3.900165846405797*^9}, {
  3.900165928877907*^9, 3.900165931094562*^9}, {3.900507221452429*^9, 
  3.900507221869989*^9}, {3.900507263939221*^9, 3.900507266659099*^9}, {
  3.900507304065806*^9, 3.900507329216206*^9}, {3.900507868453137*^9, 
  3.900507877144429*^9}, {3.901022265487055*^9, 3.901022268750958*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"98de876e-a6bf-493a-b3a1-d5a132a89403"],

Cell[BoxData[
 RowBox[{
  RowBox[{"applyActivation", "[", 
   RowBox[{"layer_", ",", " ", "inputs_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"layer", "[", "\"\<Activation\>\"", "]"}], " ", "/@", " ", 
   "inputs"}]}]], "Code",
 CellChangeTimes->{{3.900165485959984*^9, 3.900165493479166*^9}, {
  3.900165548571888*^9, 3.9001655492886467`*^9}, {3.900507216639189*^9, 
  3.900507218315398*^9}, {3.901022255363751*^9, 3.901022276703396*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"df87031d-db6b-4bc6-a67b-96b74e737cef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "feed", " ", "inputs", " ", "through", " ", "each", " ", "layer"}], ",", 
    " ", 
    RowBox[{"sowing", " ", "summations", " ", "and", " ", "activations"}]}], 
   " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"applyForwardPass", "[", 
    RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Fold", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"current", ",", " ", "layer"}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{"applyLinearLayer", "[", 
           RowBox[{"layer", ",", " ", "current"}], "]"}], ",", " ", 
          "\"\<Summations\>\""}], "]"}], " ", "//", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"Sow", "[", 
          RowBox[{
           RowBox[{"applyActivation", "[", 
            RowBox[{"layer", ",", " ", "#"}], "]"}], ",", " ", 
           "\"\<Activations\>\""}], "]"}], "&"}]}]}], "\n", "\t\t", "]"}], 
     ",", "\n", "\t\t", "inputs", ",", "\n", "\t\t", "layers"}], "\n", "\t", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900165630117494*^9, 3.900165639390486*^9}, {
  3.900165761653887*^9, 3.900165768168208*^9}, {3.900165828705814*^9, 
  3.900165830038355*^9}, {3.900165863642522*^9, 3.900165877751355*^9}, {
  3.900507250563377*^9, 3.900507315948605*^9}, {3.900507353955459*^9, 
  3.9005074325958433`*^9}, {3.900507655040917*^9, 3.900507656991757*^9}, {
  3.900507880561081*^9, 3.900507903363222*^9}, {3.901022340162389*^9, 
  3.901022353853435*^9}, {3.901022794766786*^9, 3.901022800477303*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"ffda7cc2-d670-4f52-a36a-178124c40009"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "reap", " ", "intermediates", " ", "and", " ", "return", " ", 
     "association", " ", "with", " ", "outputs"}], ",", " ", "summations", 
    ",", " ", "activations"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"reapForwardPass", "[", 
    RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"Reap", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"\"\<Outputs\>\"", " ", "->", " ", 
        RowBox[{"applyForwardPass", "[", 
         RowBox[{"layers", ",", " ", "inputs"}], "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"\"\<Summations\>\"", ",", " ", "\"\<Activations\>\""}], 
        "}"}], ",", "\n", "\t\t", "Rule"}], "\n", "\t", "]"}], " ", "//", " ",
      "Flatten"}], " ", "//", " ", 
    RowBox[{"Apply", "[", "Association", "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.900507469937497*^9, 3.900507613554356*^9}, {
  3.900507659552443*^9, 3.900507662105192*^9}, {3.900507907599413*^9, 
  3.900507931878294*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"ce3cf2e0-f924-4902-85f3-cb913ec0358e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Backpropagation", "Subsubsection",
 CellChangeTimes->{{3.9010246307879887`*^9, 3.901024631435306*^9}, {
  3.901800161644622*^9, 
  3.9018001629904737`*^9}},ExpressionUUID->"4453ef77-2ef7-4647-a1ca-\
56ec34df56c2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateLoss", "[", 
   RowBox[{
   "output_", ",", " ", "target_", ",", " ", "\"\<SumSquaredError\>\""}], 
   "]"}], " ", ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{"Total", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"output", " ", "-", " ", "target"}], ")"}], "^", "2"}], 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.901630524907728*^9, 3.901630546317006*^9}, {
  3.90163352184149*^9, 3.9016335482831583`*^9}, {3.901808177434681*^9, 
  3.901808187213448*^9}, {3.902495913558405*^9, 3.902495916162166*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c6ffa4c3-d8f5-496a-b9d3-bc3a37c5523c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateOutputDeltas", "[", 
   RowBox[{
   "output_", ",", " ", "target_", ",", " ", "summations_", ",", " ", 
    "activationFunction_", ",", " ", "\"\<SumSquaredError\>\""}], "]"}], " ", 
  ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"output", " ", "-", " ", "target"}], ")"}], " ", "*", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"activationFunction", "'"}], " ", "/@", " ", "summations"}], 
    ")"}]}]}]], "Code",
 CellChangeTimes->{{3.901630314468309*^9, 3.9016304884698277`*^9}, {
  3.901630520085877*^9, 3.901630532324779*^9}, {3.901633386574761*^9, 
  3.9016333914102173`*^9}, {3.9017147967291117`*^9, 3.901714808596643*^9}, {
  3.9017148416083403`*^9, 3.901714843689253*^9}, {3.902491032121838*^9, 
  3.902491050467914*^9}, {3.902491462944788*^9, 3.902491463944398*^9}, {
  3.902495910046281*^9, 3.902495911983239*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"89769d09-775d-4eca-a696-20f110bf56f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "take", " ", "deltas", " ", "from", " ", "downstream", " ", "layer"}], 
    ",", " ", 
    RowBox[{"weights", " ", "to", " ", "downstream", " ", "layer"}], ",", " ", 
    RowBox[{
    "and", " ", "summations", " ", "at", " ", "current", " ", "layer"}]}], 
   " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "return", " ", "deltas", " ", "for", " ", "current", " ", "layer", " ", 
    "neurons"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateNextDeltas", "[", 
    RowBox[{
    "nextDeltas_", ",", " ", "activation_", ",", " ", "weightsOut_", ",", " ",
      "summations_"}], "]"}], " ", ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"nextDeltas", " ", ".", " ", "weightsOut"}], ")"}], " ", "*", 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"activation", "'"}], " ", "/@", " ", "summations"}], 
     ")"}]}]}]}]], "Code",
 CellChangeTimes->{{3.900513274187667*^9, 3.900513469777364*^9}, {
  3.901022579228139*^9, 3.9010225937222633`*^9}, {3.901634197451151*^9, 
  3.901634198467231*^9}, {3.9024946424815397`*^9, 3.902494665586508*^9}, {
  3.903115724850971*^9, 3.903115746475389*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"c978071f-e7a0-4984-9d5d-ac0a34bee3ea"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"recursively", " ", "backpropagate", " ", "errors"}], " ", "*)"}], 
  "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "take", " ", "list", " ", "of", " ", "weights", " ", "and", " ", "cached", 
    " ", "summations", " ", "from", " ", "current", " ", "layer", " ", "down",
     " ", "to", " ", "first", " ", "layer"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "call", " ", "backpropagate", " ", "with", " ", "new", " ", "errors", " ", 
    
    RowBox[{"(", 
     RowBox[{"neuron", " ", 
      RowBox[{"deltas", ":", " ", 
       RowBox[{"del", " ", "Error", " ", "del", " ", "Summation"}]}]}], 
     ")"}]}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"backpropagateDeltas", "[", 
    RowBox[{"outputDeltas_", ",", " ", "layers_", ",", " ", "fp_"}], "]"}], 
   " ", ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"activations", " ", "=", " ", 
        RowBox[{"Most", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"layers", ",", " ", "\"\<Activation\>\""}], "]"}], "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"weights", " ", "=", " ", 
        RowBox[{"Rest", "[", 
         RowBox[{"Lookup", "[", 
          RowBox[{"layers", ",", " ", "\"\<Weights\>\""}], "]"}], "]"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"summations", " ", "=", " ", 
        RowBox[{"Most", "[", 
         RowBox[{"fp", "[", "\"\<Summations\>\"", "]"}], "]"}]}]}], "\n", 
      "\t\t", "}"}], ",", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{
      RowBox[{"FoldList", "[", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"calculateNextDeltas", "[", 
          RowBox[{"#1", ",", " ", 
           RowBox[{"Sequence", " ", "@@", " ", "#2"}]}], "]"}], "&"}], ",", 
        "\n", "\t\t\t", "outputDeltas", ",", "\n", "\t\t\t", 
        RowBox[{"Reverse", "[", 
         RowBox[{"MapThread", "[", 
          RowBox[{"List", ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "activations", ",", " ", "weights", ",", " ", "summations"}], 
            "}"}]}], "]"}], "]"}]}], "\n", "\t\t", "]"}], " ", "//", " ", 
      "Reverse"}]}], "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900603109094293*^9, 3.900603163497349*^9}, {
   3.9006032440354843`*^9, 3.900603419565837*^9}, {3.900603488475383*^9, 
   3.9006035249974318`*^9}, {3.901016285681773*^9, 3.901016286780085*^9}, {
   3.901022542297449*^9, 3.901022542639195*^9}, {3.901022581224289*^9, 
   3.9010225834412813`*^9}, {3.9010226309193773`*^9, 3.901022632832753*^9}, {
   3.901023860035762*^9, 3.901023886395125*^9}, {3.901024444557428*^9, 
   3.9010244471940107`*^9}, {3.901633638796508*^9, 3.90163364502101*^9}, {
   3.901634195420992*^9, 3.901634195855075*^9}, {3.902494658917717*^9, 
   3.902494660378654*^9}, 3.90249482154984*^9, 3.9024952770061293`*^9, {
   3.902495749939912*^9, 3.902495752564269*^9}, {3.903115762917081*^9, 
   3.903115875641626*^9}, {3.903115924608201*^9, 3.903116061914946*^9}, {
   3.9031162167486153`*^9, 3.903116218811425*^9}, {3.903116268407145*^9, 
   3.903116283918254*^9}, {3.903116348782777*^9, 3.9031163538776417`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"4577cb3b-c01f-4395-9b98-5c9aa7ca6346"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "error", " ", "gradient", " ", "wrt", " ", "weights", 
    " ", "from", " ", "gradient", " ", "wrt", " ", "summations"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"calculateWeightGradients", "[", 
    RowBox[{"allDeltas_", ",", " ", "inputs_", ",", " ", "allActivations_"}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"deltas", ",", " ", "activations"}], "}"}], ",", 
       "\[IndentingNewLine]", "\t\t\t", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"{", "deltas", "}"}], "]"}], " ", ".", " ", 
        RowBox[{"{", "activations", "}"}]}]}], "\[IndentingNewLine]", "\t\t", 
      "]"}], ",", "\[IndentingNewLine]", "\t\t", 
     RowBox[{"{", 
      RowBox[{"allDeltas", ",", " ", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Most", " ", "@", " ", "allActivations"}], ",", " ", 
         "inputs"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", "\t", 
    "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900683578897831*^9, 3.900683600900608*^9}, {
  3.900683651894773*^9, 3.900683704864881*^9}, {3.90068376612435*^9, 
  3.900683766731481*^9}, {3.901024457508309*^9, 3.901024500988913*^9}, {
  3.9017150704340773`*^9, 3.9017150731623096`*^9}, {3.901715293272192*^9, 
  3.901715295651433*^9}, {3.903093800696587*^9, 3.903093800935855*^9}, {
  3.90311522604278*^9, 3.903115226450479*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"6269aca1-c6c8-41b8-aa7d-7582da787ed3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "calculate", " ", "all", " ", "neuron", " ", "deltas", " ", "and", " ", 
    "weight", " ", "gradients", " ", "by", " ", "backpropagating", " ", 
    "errors"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{"backwardPass", "[", 
    RowBox[{"layers_", ",", " ", "labelledInput_Rule", ",", " ", 
     RowBox[{"lossFunction_", " ", ":", " ", "\"\<SumSquaredError\>\""}]}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "fp", ",", " ", "outputDeltas", ",", " ", "allDeltas", ",", " ", 
       "weightGradients"}], "}"}], ",", "\n", "\n", "\t\t", 
     RowBox[{
      RowBox[{"fp", " ", "=", " ", 
       RowBox[{"reapForwardPass", "[", 
        RowBox[{"layers", ",", " ", 
         RowBox[{"First", " ", "@", " ", "labelledInput"}]}], "]"}]}], ";", 
      "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"outputDeltas", " ", "=", " ", 
       RowBox[{"calculateOutputDeltas", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"fp", "[", "\"\<Outputs\>\"", "]"}], ",", " ", 
         RowBox[{"Last", "[", "labelledInput", "]"}], ",", " ", 
         RowBox[{"Last", "[", 
          RowBox[{"fp", "[", "\"\<Summations\>\"", "]"}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"Last", "[", "layers", "]"}], "[", "\"\<Activation\>\"", 
          "]"}], ",", " ", "\"\<SumSquaredError\>\""}], "\n", "\t\t", "]"}]}],
       ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"allDeltas", " ", "=", " ", 
       RowBox[{"backpropagateDeltas", "[", "\n", "\t\t\t", 
        RowBox[{
        "outputDeltas", ",", "\n", "\t\t\t", "layers", ",", "\n", "\t\t\t", 
         "fp"}], "\n", "\t\t", "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"weightGradients", " ", "=", " ", 
       RowBox[{"calculateWeightGradients", "[", "\n", "\t\t\t", 
        RowBox[{"allDeltas", ",", " ", 
         RowBox[{"First", " ", "@", " ", "labelledInput"}], ",", " ", 
         RowBox[{"fp", "[", "\"\<Activations\>\"", "]"}]}], "\n", "\t\t", 
        "]"}]}], ";", "\n", "\t\t", "\n", "\t\t", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<AllDeltas\>\"", " ", "->", " ", "allDeltas"}], ",", " ", 
        
        RowBox[{
        "\"\<WeightGradients\>\"", " ", "->", " ", "weightGradients"}]}], 
       "|>"}]}]}], "\n", "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900603002712975*^9, 3.9006031353216047`*^9}, {
   3.9006031920869503`*^9, 3.90060319414911*^9}, {3.900603536803502*^9, 
   3.900603539077364*^9}, {3.900603861458612*^9, 3.900603954871955*^9}, {
   3.900679070071116*^9, 3.900679075117937*^9}, {3.900679252987653*^9, 
   3.900679254193552*^9}, {3.9006794183390903`*^9, 3.900679431681649*^9}, {
   3.90067972445361*^9, 3.9006797264765997`*^9}, {3.900680336206019*^9, 
   3.900680365409309*^9}, {3.900681004503878*^9, 3.900681007033812*^9}, {
   3.9006810832099524`*^9, 3.900681084787387*^9}, {3.9006818885415897`*^9, 
   3.900681890533628*^9}, {3.9006838203710938`*^9, 3.900683933603942*^9}, {
   3.901016988597704*^9, 3.901017008641122*^9}, {3.901017082987296*^9, 
   3.90101714910404*^9}, {3.901022435652149*^9, 3.9010224493821077`*^9}, {
   3.901022517938695*^9, 3.901022537450086*^9}, {3.9010233265755873`*^9, 
   3.9010233718543043`*^9}, {3.901023628161152*^9, 3.901023729218135*^9}, {
   3.9010239735517282`*^9, 3.9010239918664417`*^9}, {3.9010243394036217`*^9, 
   3.901024419421636*^9}, {3.901109424900104*^9, 3.901109432657909*^9}, {
   3.9011096203235903`*^9, 3.901109631183823*^9}, 3.901197925373547*^9, 
   3.901286683886101*^9, {3.901290491926249*^9, 3.9012904922836447`*^9}, {
   3.90163340476285*^9, 3.90163351084157*^9}, 3.9016335699140177`*^9, {
   3.901633653455207*^9, 3.901633653971277*^9}, {3.901633732971491*^9, 
   3.9016337373499193`*^9}, {3.901634349624419*^9, 3.901634361055748*^9}, {
   3.901634567783557*^9, 3.901634572579876*^9}, {3.901634709508745*^9, 
   3.90163473147639*^9}, {3.9016347630880003`*^9, 3.9016347655467663`*^9}, {
   3.9016350430153923`*^9, 3.9016350513871183`*^9}, {3.9017148874374933`*^9, 
   3.901714890412567*^9}, {3.901715075531643*^9, 3.9017150877927647`*^9}, {
   3.9017152767281513`*^9, 3.901715324911949*^9}, {3.90171637601492*^9, 
   3.901716377744401*^9}, 3.901716789031891*^9, {3.9018029975828447`*^9, 
   3.9018029983686934`*^9}, {3.902492101503813*^9, 3.902492103467415*^9}, {
   3.9024925073248672`*^9, 3.9024925685190983`*^9}, {3.9024929187289257`*^9, 
   3.9024929443456593`*^9}, {3.9024946978919783`*^9, 
   3.9024946997368793`*^9}, {3.903116459632155*^9, 3.903116472889105*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"3d3648c8-da14-4990-9872-6260359c2f8c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Training", "Subsubsection",
 CellChangeTimes->{{3.901800171954215*^9, 
  3.901800172583991*^9}},ExpressionUUID->"9ae4a78d-7d02-4250-924e-\
2b4968ff5cc5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"accumulateGradients", "[", 
   RowBox[{"layers_", ",", " ", "data_", ",", " ", "lossFunction_"}], "]"}], 
  " ", ":=", "\[IndentingNewLine]", "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gradients", " ", "=", " ", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"backwardPass", "[", 
          RowBox[{"layers", ",", " ", "#", ",", " ", "lossFunction"}], "]"}], 
         "&"}], ",", " ", "data"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<WeightGradients\>\"", " ", "->", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"Lookup", "[", 
         RowBox[{"gradients", ",", " ", "\"\<WeightGradients\>\""}], "]"}], 
        "]"}]}], ",", "\n", "\t\t\t", 
      RowBox[{"\"\<AllDeltas\>\"", " ", "->", " ", 
       RowBox[{"Total", "[", 
        RowBox[{"Lookup", "[", 
         RowBox[{"gradients", ",", " ", "\"\<AllDeltas\>\""}], "]"}], 
        "]"}]}]}], "\n", "\t\t", "|>"}]}], "\n", "\t", "]"}]}]], "Code",
 CellChangeTimes->{{3.9018029570628023`*^9, 3.901802968910029*^9}, {
  3.901803019869458*^9, 3.901803045487597*^9}, {3.901803083372738*^9, 
  3.9018030893433037`*^9}, {3.9018031248731947`*^9, 3.9018031439599953`*^9}, {
  3.90180321689712*^9, 3.901803263510257*^9}, {3.9018042831848803`*^9, 
  3.9018042954398003`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"ebd0cc6d-a947-4085-b2e7-6757282650d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "update", " ", "weights", " ", "to", " ", "reduce", " ", "overall", " ", 
    "loss", " ", "according", " ", "to", " ", "learning", " ", "rate"}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"gradientDescentStep", "[", 
    RowBox[{"layers_", ",", " ", "gradients_", ",", " ", "learningRate_"}], 
    "]"}], " ", ":=", "\n", "\t", 
   RowBox[{"MapThread", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"layer", ",", " ", "weightGradients", ",", " ", "allDeltas"}],
         "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"Append", "[", 
        RowBox[{"layer", ",", " ", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<Weights\>\"", " ", "->", " ", 
            RowBox[{
             RowBox[{"layer", "[", "\"\<Weights\>\"", "]"}], " ", "-", " ", 
             RowBox[{"weightGradients", " ", "*", " ", "learningRate"}]}]}], 
           ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<Biases\>\"", " ", "->", " ", 
            RowBox[{
             RowBox[{"layer", "[", "\"\<Biases\>\"", "]"}], " ", "-", " ", 
             RowBox[{
             "allDeltas", " ", "*", " ", "learningRate", " ", "*", " ", 
              ".1"}]}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t", 
      "]"}], ",", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"layers", ",", " ", 
       RowBox[{"gradients", "[", "\"\<WeightGradients\>\"", "]"}], ",", " ", 
       RowBox[{"gradients", "[", "\"\<AllDeltas\>\"", "]"}]}], "}"}]}], "\n", 
    "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.900511912821782*^9, 3.9005119277274942`*^9}, {
  3.9005120744633512`*^9, 3.900512114151217*^9}, {3.900512159443112*^9, 
  3.900512178917329*^9}, {3.9005122129540987`*^9, 3.900512229616536*^9}, {
  3.9005124295229692`*^9, 3.9005124753163*^9}, {3.900512577362719*^9, 
  3.9005126674032087`*^9}, {3.900690081863041*^9, 3.9006900825742197`*^9}, {
  3.901023351593383*^9, 3.901023361245179*^9}, {3.9010245101732807`*^9, 
  3.901024537054229*^9}, {3.9011094916945*^9, 3.901109589463689*^9}, {
  3.901109702052659*^9, 3.901109726040989*^9}, {3.901803367029604*^9, 
  3.901803408183029*^9}, {3.901807700310163*^9, 3.901807729707556*^9}, {
  3.90180800010515*^9, 3.901808009705418*^9}, {3.903116635706853*^9, 
  3.903116637273943*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"55ffb453-17d3-4ee3-8002-929f5b7a7b22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"batchData", "[", 
   RowBox[{"data_", ",", " ", "batchSize_"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"RandomSample", "[", "data", "]"}], ",", " ", 
    RowBox[{"UpTo", "[", "batchSize", "]"}]}], "]"}]}]], "Code",
 CellChangeTimes->{{3.901803647683426*^9, 3.901803688354351*^9}, {
  3.901803946756959*^9, 3.9018039667405443`*^9}, {3.901806586335393*^9, 
  3.901806595329319*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"21d00233-0056-4aae-8a25-bae8fad87dc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainEpoch", "[", 
   RowBox[{"layers_List", ",", " ", "trainingData_List", ",", " ", 
    RowBox[{"learningRate_", " ", ":", " ", ".1"}], ",", " ", 
    RowBox[{"lossFunction_", " ", ":", " ", "\"\<SumSquaredError\>\""}], ",", 
    " ", "batchSize_"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{"Fold", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"Function", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"currentLayers", ",", " ", "currentBatch"}], "}"}], ",", "\n", 
      "\t\t\t", 
      RowBox[{"gradientDescentStep", "[", "\n", "\t\t\t\t", 
       RowBox[{"currentLayers", ",", "\n", "\t\t\t\t", 
        RowBox[{"accumulateGradients", "[", 
         RowBox[{
         "currentLayers", ",", " ", "currentBatch", ",", " ", 
          "lossFunction"}], "]"}], ",", "\n", "\t\t\t\t", "learningRate"}], 
       "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}], ",", "\n", "\t\t", 
    "layers", ",", "\n", "\t\t", 
    RowBox[{"batchData", "[", 
     RowBox[{"trainingData", ",", " ", "batchSize"}], "]"}]}], "\n", "\t", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.9017998811919527`*^9, 3.9017998823245993`*^9}, {
   3.901800060204404*^9, 3.901800066340807*^9}, {3.901800105808702*^9, 
   3.901800106197691*^9}, {3.901800256415745*^9, 3.9018002699733686`*^9}, {
   3.901801415205435*^9, 3.901801463767913*^9}, {3.901802341326042*^9, 
   3.901802523560871*^9}, {3.901802558579474*^9, 3.901802568992914*^9}, {
   3.901802676821824*^9, 3.901802693324708*^9}, {3.901803004306834*^9, 
   3.9018030046132927`*^9}, {3.901803417294675*^9, 3.901803515821364*^9}, {
   3.901803588619659*^9, 3.901803597707511*^9}, {3.9018039753222647`*^9, 
   3.9018039808559933`*^9}, {3.9018041214391193`*^9, 
   3.9018041219136257`*^9}, {3.901804277027039*^9, 3.90180427969048*^9}, {
   3.901806582375071*^9, 3.90180660700559*^9}, {3.901806722544519*^9, 
   3.901806723606635*^9}, 3.901806768872971*^9, {3.9018070881672783`*^9, 
   3.901807095641223*^9}, {3.902320877800837*^9, 3.9023208873177137`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"e345657e-15d6-4d2d-b835-d1f1fe20f2cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makePredictions", "[", 
   RowBox[{"layers_", ",", " ", "inputs_"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{"AssociationMap", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{
     RowBox[{"applyForwardPass", "[", 
      RowBox[{"layers", ",", " ", "#"}], "]"}], "&"}], ",", "\n", "\t\t", 
    "inputs"}], "\n", "\t", "]"}]}]], "Code",
 CellChangeTimes->{{3.901808338422319*^9, 3.9018083606827707`*^9}, {
  3.9018084234844913`*^9, 3.9018084844300833`*^9}, {3.902318616734191*^9, 
  3.902318639496204*^9}, {3.902318926016821*^9, 3.902318930414456*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"686ab6de-c707-4159-adf2-cea8d319cb8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"calculateTotalLoss", "[", 
   RowBox[{
   "layers_", ",", " ", "labelledInputs_", ",", " ", "lossFunction_"}], "]"}],
   " ", ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Map", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Function", "[", 
      RowBox[{"labelledInput", ",", "\n", "\t\t\t", 
       RowBox[{"calculateLoss", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"applyForwardPass", "[", 
          RowBox[{"layers", ",", " ", 
           RowBox[{"First", " ", "@", " ", "labelledInput"}]}], "]"}], ",", 
         "\n", "\t\t\t\t", 
         RowBox[{"Last", " ", "@", " ", "labelledInput"}], ",", "\n", 
         "\t\t\t\t", "lossFunction"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
      "]"}], ",", "\n", "\t\t", "labelledInputs"}], "\n", "\t", "]"}], " ", "//",
    " ", "Total"}]}]], "Code",
 CellChangeTimes->{{3.901808168127442*^9, 3.9018082797681017`*^9}, 
   3.902318668182548*^9, {3.902318717493987*^9, 3.902318769718895*^9}, {
   3.90231884317493*^9, 3.902318868934816*^9}, {3.902319109072929*^9, 
   3.90231911429668*^9}, {3.9023204182773848`*^9, 3.90232062524131*^9}, {
   3.902320766670869*^9, 3.90232086185649*^9}, {3.902320902295478*^9, 
   3.9023209361342173`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f7f3a6ff-ea12-46b9-b4b5-5b0e9387a27e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"train", " ", "network"}], ",", " ", 
    RowBox[{"returning", " ", "final", " ", "result", " ", "only"}]}], " ", 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{"trainNetwork", "[", 
    RowBox[{"initialLayers_List", ",", " ", "trainingData_List", ",", " ", 
     RowBox[{"learningRate_", " ", ":", " ", ".1"}], ",", " ", 
     RowBox[{"lossFunction_", " ", ":", " ", "\"\<SumSquaredError\>\""}], ",",
      " ", "batchSize_", ",", " ", "epochs_"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", "\t", 
   RowBox[{"Nest", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Sow", "[", 
       RowBox[{"trainEpoch", "[", 
        RowBox[{
        "#", ",", " ", "trainingData", ",", " ", "learningRate", ",", " ", 
         "lossFunction", ",", " ", "batchSize"}], "]"}], "]"}], "&"}], ",", 
     " ", "\n", "\t\t", "initialLayers", ",", "\n", "\t\t", "epochs"}], "\n", 
    "\t", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.901806615723435*^9, 3.901806665380992*^9}, {
  3.901806725143881*^9, 3.901806793795467*^9}, {3.90231852496126*^9, 
  3.902318526742195*^9}, {3.9023188892326727`*^9, 3.902318905232362*^9}, {
  3.902405936795697*^9, 3.902405941137631*^9}, {3.902487548349173*^9, 
  3.902487563769326*^9}, {3.902487962089617*^9, 3.9024879642197866`*^9}, {
  3.9024880592168713`*^9, 3.902488059745702*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"5e2f8e5b-1e6f-4b8c-9ddd-67f584f73e53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trainingProgress", "[", 
   RowBox[{"initialLayers_List", ",", " ", "trainingData_List", ",", " ", 
    RowBox[{"learningRate_", " ", ":", " ", ".1"}], ",", " ", 
    RowBox[{"lossFunction_", " ", ":", " ", "\"\<SumSquaredError\>\""}], ",", 
    " ", "batchSize_", ",", " ", "epochs_"}], "]"}], " ", ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "networks", ",", " ", "trainingLoss", ",", " ", "validationLoss"}], 
     "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"networks", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Rest", " ", "@", " ", 
         RowBox[{"Reap", "[", 
          RowBox[{"trainNetwork", "[", 
           RowBox[{
           "initialLayers", ",", " ", "trainingData", ",", " ", 
            "learningRate", ",", " ", "lossFunction", ",", " ", "batchSize", 
            ",", " ", "epochs"}], "]"}], "]"}]}], ",", " ", "2"}], "]"}]}], 
     ";", "\n", "\t\t", 
     RowBox[{"trainingLoss", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"calculateTotalLoss", "[", 
         RowBox[{"#", ",", " ", "trainingData", ",", " ", "lossFunction"}], 
         "]"}], "&"}], " ", "/@", " ", "networks"}]}], ";", "\n", "\t\t", 
     RowBox[{"validationLoss", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"calculateTotalLoss", "[", 
         RowBox[{"#", ",", " ", "trainingData", ",", " ", "lossFunction"}], 
         "]"}], "&"}], " ", "/@", " ", "networks"}]}], ";", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{"trainingLoss", ",", " ", "validationLoss"}], "}"}]}]}], "\n", 
   "\t", "]"}]}]], "Code",
 CellChangeTimes->{{3.902487565645237*^9, 3.9024876285532923`*^9}, {
   3.902487733939928*^9, 3.902487741726511*^9}, {3.902487796850656*^9, 
   3.902487798804461*^9}, {3.902487836454687*^9, 3.9024878537190123`*^9}, {
   3.902487966808549*^9, 3.902488073147912*^9}, {3.9024881116586723`*^9, 
   3.902488232561159*^9}, {3.902493171826977*^9, 3.902493181481804*^9}, {
   3.90249347282369*^9, 3.9024934734339*^9}, {3.902493516486308*^9, 
   3.902493546615488*^9}, 3.9024936010136147`*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"fd100fd2-a1b9-492c-85ba-563c55ec2a57"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["TODO", "Section",
 CellChangeTimes->{{3.901017910874044*^9, 3.901017911156982*^9}, {
  3.901717746283791*^9, 
  3.901717747497302*^9}},ExpressionUUID->"6b89ddd4-54ac-4090-959f-\
2a5a8f117b8e"],

Cell["Debug backpropagation", "Item",
 CellChangeTimes->{{3.90101791389244*^9, 3.901017981170682*^9}, {
  3.90102245761898*^9, 3.901022464738422*^9}, {3.901023127951206*^9, 
  3.9010231279535503`*^9}, {3.901808087105549*^9, 3.9018081028760767`*^9}, {
  3.902579924471685*^9, 
  3.902579928972704*^9}},ExpressionUUID->"e169d252-a49f-4ce6-b862-\
51ac89d36376"],

Cell["Use Options for function parameters", "Item",
 CellChangeTimes->{{3.90101791389244*^9, 3.901017981170682*^9}, {
  3.90102245761898*^9, 3.901022464738422*^9}, {3.901023127951206*^9, 
  3.9010231279535503`*^9}, {3.901808087105549*^9, 
  3.9018081028760767`*^9}},ExpressionUUID->"a9fc2185-bae6-4cb2-96d9-\
94eff92d1f62"],

Cell["Additional loss functions", "Item",
 CellChangeTimes->{{3.90101791389244*^9, 3.901017981170682*^9}, {
  3.90102245761898*^9, 3.901022464738422*^9}, {3.901023127951206*^9, 
  3.9010231279535503`*^9}, {3.901808087105549*^9, 
  3.901808092901252*^9}},ExpressionUUID->"3ae5c4c7-079d-4201-a009-\
d585ede6dafe"],

Cell["Show progression over training", "Item",
 CellChangeTimes->{{3.90101791389244*^9, 3.901017981170682*^9}, {
  3.90102245761898*^9, 3.901022464738422*^9}, {3.901023128536518*^9, 
  3.9010231703755283`*^9}, {3.901024664008589*^9, 3.901024723721498*^9}, {
  3.901110146663105*^9, 3.901110149516782*^9}, {3.90180806924936*^9, 
  3.901808071855287*^9}},ExpressionUUID->"9a665ae3-438c-46db-9abf-\
34069572145a"],

Cell["Full example usage", "Item",
 CellChangeTimes->{{3.90101791389244*^9, 3.901017981170682*^9}, {
  3.90102245761898*^9, 3.901022464738422*^9}, {3.901023128536518*^9, 
  3.9010231703755283`*^9}, {3.901024664008589*^9, 3.901024723721498*^9}, {
  3.901110146663105*^9, 3.901110149516782*^9}, {3.90180806924936*^9, 
  3.9018080831958513`*^9}},ExpressionUUID->"08800a08-9f69-4bc2-8fdb-\
6c4091fb6747"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{779.0943396226414, 928.5283018867924},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules-><|"TryRealOnly" -> False|>,
Magnification:>1.1 Inherited,
FrontEndVersion->"13.2 for Linux x86 (64-bit) (January 31, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a227bd47-836e-473b-946f-c2bac241dc7a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 182, 3, 81, "Title",ExpressionUUID->"ca3228e6-303f-43ae-8a31-1f1db99b771c"],
Cell[765, 27, 283, 7, 67, "Subsection",ExpressionUUID->"34157afd-8aae-46c5-a27a-5e0c13c73a08"],
Cell[CellGroupData[{
Cell[1073, 38, 165, 3, 45, "Section",ExpressionUUID->"04a6c63a-cf94-442e-a622-d92ff422cef2"],
Cell[CellGroupData[{
Cell[1263, 45, 160, 3, 37, "Subsubsection",ExpressionUUID->"ca5b47ac-52a1-4b2e-8d69-d5d72eb6fdb1"],
Cell[1426, 50, 1923, 39, 184, "Code",ExpressionUUID->"aa04fd5b-1529-45b5-bbc3-c5dedb8eb63c"],
Cell[3352, 91, 753, 14, 64, "Code",ExpressionUUID->"98de876e-a6bf-493a-b3a1-d5a132a89403"],
Cell[4108, 107, 524, 10, 47, "Code",ExpressionUUID->"df87031d-db6b-4bc6-a67b-96b74e737cef"],
Cell[4635, 119, 1755, 39, 215, "Code",ExpressionUUID->"ffda7cc2-d670-4f52-a36a-178124c40009"],
Cell[6393, 160, 1155, 26, 160, "Code",ExpressionUUID->"ce3cf2e0-f924-4902-85f3-cb913ec0358e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7585, 191, 219, 4, 37, "Subsubsection",ExpressionUUID->"4453ef77-2ef7-4647-a1ca-56ec34df56c2"],
Cell[7807, 197, 629, 14, 67, "Code",ExpressionUUID->"c6ffa4c3-d8f5-496a-b9d3-bc3a37c5523c"],
Cell[8439, 213, 982, 20, 67, "Code",ExpressionUUID->"89769d09-775d-4eca-a696-20f110bf56f9"],
Cell[9424, 235, 1281, 32, 100, "Code",ExpressionUUID->"c978071f-e7a0-4984-9d5d-ac0a34bee3ea"],
Cell[10708, 269, 3275, 70, 328, "Code",ExpressionUUID->"4577cb3b-c01f-4395-9b98-5c9aa7ca6346"],
Cell[13986, 341, 1638, 36, 181, "Code",ExpressionUUID->"6269aca1-c6c8-41b8-aa7d-7582da787ed3"],
Cell[15627, 379, 4668, 83, 407, "Code",ExpressionUUID->"3d3648c8-da14-4990-9872-6260359c2f8c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20332, 467, 159, 3, 37, "Subsubsection",ExpressionUUID->"9ae4a78d-7d02-4250-924e-2b4968ff5cc5"],
Cell[20494, 472, 1492, 33, 158, "Code",ExpressionUUID->"ebd0cc6d-a947-4085-b2e7-6757282650d4"],
Cell[21989, 507, 2453, 50, 237, "Code",ExpressionUUID->"55ffb453-17d3-4ee3-8002-929f5b7a7b22"],
Cell[24445, 559, 539, 11, 67, "Code",ExpressionUUID->"21d00233-0056-4aae-8a25-bae8fad87dc2"],
Cell[24987, 572, 2099, 38, 254, "Code",ExpressionUUID->"e345657e-15d6-4d2d-b835-d1f1fe20f2cb"],
Cell[27089, 612, 662, 13, 123, "Code",ExpressionUUID->"686ab6de-c707-4159-adf2-cea8d319cb8a"],
Cell[27754, 627, 1313, 27, 235, "Code",ExpressionUUID->"f7f3a6ff-ea12-46b9-b4b5-5b0e9387a27e"],
Cell[29070, 656, 1459, 30, 155, "Code",ExpressionUUID->"5e2f8e5b-1e6f-4b8c-9ddd-67f584f73e53"],
Cell[30532, 688, 2240, 47, 168, "Code",ExpressionUUID->"fd100fd2-a1b9-492c-85ba-563c55ec2a57"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32821, 741, 198, 4, 56, "Section",ExpressionUUID->"6b89ddd4-54ac-4090-959f-2a5a8f117b8e"],
Cell[33022, 747, 358, 6, 26, "Item",ExpressionUUID->"e169d252-a49f-4ce6-b862-51ac89d36376"],
Cell[33383, 755, 323, 5, 26, "Item",ExpressionUUID->"a9fc2185-bae6-4cb2-96d9-94eff92d1f62"],
Cell[33709, 762, 311, 5, 26, "Item",ExpressionUUID->"3ae5c4c7-079d-4201-a009-d585ede6dafe"],
Cell[34023, 769, 410, 6, 26, "Item",ExpressionUUID->"9a665ae3-438c-46db-9abf-34069572145a"],
Cell[34436, 777, 400, 6, 26, "Item",ExpressionUUID->"08800a08-9f69-4bc2-8fdb-6c4091fb6747"]
}, Open  ]]
}, Open  ]]
}
]
*)

